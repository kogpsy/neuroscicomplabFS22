<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.301">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Andrew Ellis">
<meta name="dcterms.date" content="2022-05-10">
<meta name="description" content="Combining informatin from multiple participants | Intro to Bayesian data anlysis.">
<title>Neurowissenschaft Computerlab - Data analysis: I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>
<script src="../../site_libs/quarto-nav/quarto-nav.js"></script><script src="../../site_libs/quarto-nav/headroom.min.js"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script><script src="../../site_libs/quarto-search/fuse.min.js"></script><script src="../../site_libs/quarto-search/quarto-search.js"></script><link href="../..//assets/logo_landing.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script><script src="../../site_libs/quarto-html/popper.min.js"></script><script src="../../site_libs/quarto-html/tippy.umd.min.js"></script><script src="../../site_libs/quarto-html/anchor.min.js"></script><link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link class="quarto-color-scheme" id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script><link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link class="quarto-color-scheme" href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="../../site_libs/bootstrap/bootstrap-dark.min.css">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles/global.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <img src="../../assets/logo.png" alt=""><span class="navbar-title">Neurowissenschaft Computerlab</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-admin" role="button" data-bs-toggle="dropdown" aria-expanded="false">Admin</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-admin">
<li>
    <a class="dropdown-item" href="../../pages/admin/01_overview.html">
 <span class="dropdown-text">√úbersicht</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/admin/02_assessments.html">
 <span class="dropdown-text">Leistungskontrollen</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/admin/03_zulip_forum.html">
 <span class="dropdown-text">Zulip Forum</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-kapitel" role="button" data-bs-toggle="dropdown" aria-expanded="false">Kapitel</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-kapitel">
<li>
    <a class="dropdown-item" href="../../pages/chapters/01_psychopy_experiments.html">
 <span class="dropdown-text">Verhaltensexperiment mit PsychoPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/02_importing_data.html">
 <span class="dropdown-text">Daten importieren</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/03_data_cleaning.html">
 <span class="dropdown-text">Data cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/04_summarizing_data.html">
 <span class="dropdown-text">Daten bearbeiten und zusammenfassen</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/05_signal_detection_i.html">
 <span class="dropdown-text">Signal Detection Theory: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/06_signal_detection_ii.html">
 <span class="dropdown-text">Signal Detection Theory: II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/07_response_times_i.html">
 <span class="dropdown-text">Reaktionszeiten: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/08_response_times_ii.html">
 <span class="dropdown-text">Reaktionszeiten: II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/09_evidence_accumulation_1.html">
 <span class="dropdown-text">Evidence Accumulation Models: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/10_evidence_accumulation_2.html">
 <span class="dropdown-text">Evidence Accumulation Models: II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/11_data-analysis-1.html">
 <span class="dropdown-text">Data analysis: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/12_data-analysis-2.html">
 <span class="dropdown-text">Data analysis: II</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false">Slides</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-slides">
<li>
    <a class="dropdown-item" href="../../slides/01_introduction.html">
 <span class="dropdown-text">1. Sitzung (22.02.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/02_psychopy.html">
 <span class="dropdown-text">2. Sitzung (01.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/03_import_and_process_data.html">
 <span class="dropdown-text">3. Sitzung (08.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/04_process_data.html">
 <span class="dropdown-text">4. Sitzung (15.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/05_signal_detection.html">
 <span class="dropdown-text">5. Sitzung (22.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/06_signal_detection_examples.html">
 <span class="dropdown-text">6. Sitzung (29.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/07_response_times.html">
 <span class="dropdown-text">7. Sitzung (05.04.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/08_response_times_ii.html">
 <span class="dropdown-text">8. Sitzung (12.04.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/09_evidence_accumulation.html">
 <span class="dropdown-text">9. Sitzung (26.04.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/10_fitting_ddm.html">
 <span class="dropdown-text">10. Sitzung (03.05.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/11_data-analysis-1.html">
 <span class="dropdown-text">11. Sitzung (17.05.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/12_data-analysis-2.html">
 <span class="dropdown-text">12. Sitzung (24.05.2022)</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bungen" role="button" data-bs-toggle="dropdown" aria-expanded="false">√úbungen</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bungen">
<li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_01.html">
 <span class="dropdown-text">√úbung 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_02.html">
 <span class="dropdown-text">√úbung 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_03.html">
 <span class="dropdown-text">√úbung 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_04.html">
 <span class="dropdown-text">√úbung 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_05.html">
 <span class="dropdown-text">√úbung 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_06.html">
 <span class="dropdown-text">√úbung 6</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-l√∂sungen" role="button" data-bs-toggle="dropdown" aria-expanded="false">L√∂sungen</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-l√∂sungen">
<li>
    <a class="dropdown-item" href="../../pages/solutions/solution_03.html">
 <span class="dropdown-text">√úbung 3: L√∂sung</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#data-analysis" id="toc-data-analysis" class="nav-link active" data-scroll-target="#data-analysis">Data analysis</a></li>
  <li>
<a href="#modelling-and-summarizing-data-from-multiple-participants" id="toc-modelling-and-summarizing-data-from-multiple-participants" class="nav-link" data-scroll-target="#modelling-and-summarizing-data-from-multiple-participants">Modelling and summarizing data from multiple participants</a>
  <ul class="collapse">
<li><a href="#complete-pooling" id="toc-complete-pooling" class="nav-link" data-scroll-target="#complete-pooling">Complete pooling</a></li>
  </ul>
</li>
  <li><a href="#no-pooling" id="toc-no-pooling" class="nav-link" data-scroll-target="#no-pooling">No pooling</a></li>
  <li><a href="#partial-pooling" id="toc-partial-pooling" class="nav-link" data-scroll-target="#partial-pooling">Partial pooling</a></li>
  <li>
<a href="#frequentist-statistics" id="toc-frequentist-statistics" class="nav-link" data-scroll-target="#frequentist-statistics">Frequentist statistics</a>
  <ul class="collapse">
<li><a href="#what-can-we-discover-with-nhst" id="toc-what-can-we-discover-with-nhst" class="nav-link" data-scroll-target="#what-can-we-discover-with-nhst">What can we discover with NHST?</a></li>
  </ul>
</li>
  <li><a href="#problems-with-nhst" id="toc-problems-with-nhst" class="nav-link" data-scroll-target="#problems-with-nhst">Problems with NHST</a></li>
  <li>
<a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case studies</a>
  <ul class="collapse">
<li><a href="#sec-fancyhat" id="toc-sec-fancyhat" class="nav-link" data-scroll-target="#sec-fancyhat">T-test</a></li>
  <li><a href="#card-game" id="toc-card-game" class="nav-link" data-scroll-target="#card-game">Card game</a></li>
  </ul>
</li>
  <li><a href="#an-introduction-to-bayesian-inference" id="toc-an-introduction-to-bayesian-inference" class="nav-link" data-scroll-target="#an-introduction-to-bayesian-inference">An introduction to Bayesian inference</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#bayesian-inference-in-the-card-game-a-numerical-example" id="toc-bayesian-inference-in-the-card-game-a-numerical-example" class="nav-link" data-scroll-target="#bayesian-inference-in-the-card-game-a-numerical-example">Bayesian inference in the card game: a numerical example</a></li>
  <li>
<a href="#analytic-solution-for-the-bernoullibinomial-likelihood-and-beta-prior" id="toc-analytic-solution-for-the-bernoullibinomial-likelihood-and-beta-prior" class="nav-link" data-scroll-target="#analytic-solution-for-the-bernoullibinomial-likelihood-and-beta-prior">Analytic solution for the Bernoulli/Binomial likelihood and Beta prior</a>
  <ul class="collapse">
<li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  <li><a href="#summarizing-the-posterior" id="toc-summarizing-the-posterior" class="nav-link" data-scroll-target="#summarizing-the-posterior">Summarizing the posterior</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Data analysis: I</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    <p>Combining informatin from multiple participants | Intro to Bayesian data anlysis.</p>
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">Andrew Ellis <a href="https://orcid.org/0000-0002-2788-936X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>

    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.kog.psy.unibe.ch">
            Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universit√§t Bern
            </a>
          </p>
      </div>
    </div>



<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2022-05-10</p>
    </div>
  </div>
    
  </div>
  

</header><!-- :::{.callout-note} --><!-- üëâ [R Code f√ºr dieses Kapitel downloaden](../../downloadable_files/evidence-accumulation-1.R) --><!-- ::: --><!-- t-test --><!--     - Lee --><!-- Signal detection --><!--     - Lee --><!--     - Farrell --><div class="cell">

</div>
<section id="data-analysis" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="data-analysis">Data analysis</h2>
<p>In this chapter, we will tackle two important topics:</p>
<ol type="1">
<li><p>What methods should we use when modelling and summarizing data from multiple participants, and</p></li>
<li><p>Which alternative approaches are available when methods for null hypothesis significance testing (NHST) are not suitable.</p></li>
</ol>
<p>The latter is often the case in neuroscience, where low power due to small sample sizes is a well-known problem <span class="citation" data-cites="buttonPowerFailureWhy2013">(<a href="#ref-buttonPowerFailureWhy2013" role="doc-biblioref">Button et al. 2013</a>)</span>. The alternative approach we will discuss here is Bayesian data analysis, which also has the benefit is allowing us to provide evidence <em>for</em> or <em>against</em> hypotheses, something which is not possible using NHST.</p>
<div class="no-row-height column-margin column-container"><div id="ref-buttonPowerFailureWhy2013" class="csl-entry" role="doc-biblioentry">
Button, Katherine S., John P. A. Ioannidis, Claire Mokrysz, Brian A. Nosek, Jonathan Flint, Emma S. J. Robinson, and Marcus R. Munaf√≤. 2013. <span>‚ÄúPower Failure: Why Small Sample Size Undermines the Reliability of Neuroscience.‚Äù</span> <em>Nature Reviews Neuroscience</em> 14 (5): 365‚Äì76. <a href="https://doi.org/10.1038/nrn3475">https://doi.org/10.1038/nrn3475</a>.
</div></div></section><section id="modelling-and-summarizing-data-from-multiple-participants" class="level2"><h2 class="anchored" data-anchor-id="modelling-and-summarizing-data-from-multiple-participants">Modelling and summarizing data from multiple participants</h2>
<p>In most neuroscience experiments, we are interested in effects of manipulations at the individual level, but we also need to be sure that theses effects hold at the group level, and are not particular to certain individuals. However, reporting effects at the group level is not straightforward.In short, there are three possiblities when combining informatin from multiple participants:</p>
<section id="complete-pooling" class="level3"><h3 class="anchored" data-anchor-id="complete-pooling">Complete pooling</h3>
<p>We can pretend that all our data come from 1 participant, by averaging over participants. In statistics, this is know as <em>complete pooling</em>, meaning that all data are pooled and we are no longer interested in individual participants. The pooled data are then used to estimate parameters, and to perfom hypothesis testing. While there are cases in which it is possible to analyze averaged data, in general this approach can lead to errors, and needs to be treated with care. A classic example is shown in <a href="#fig-power-law">Figure&nbsp;1</a>. The thin solid lines represent individual learning curves. Each indivdial appears to learn very rapidly (and linearly), but there is a huge variation in the onset of learning. The filled circles represent a naive attempt at averaging over all individuals. The result suggests that learning is gradual and starts from the outset; however the average learning curve looks nothing like the individual learning curves. This type of analysis can lead to erroneous conclusions.</p>
<div id="fig-power-law" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="../../assets/images/aggregating-power-law.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Learning curves</figcaption><p></p>
</figure>
</div>
</section></section><section id="no-pooling" class="level2"><h2 class="anchored" data-anchor-id="no-pooling">No pooling</h2>
<p>This means that data we estimate parameters of our models for each participant separately. While this appears to be a more sensible approach, there is the danger of over-fitting. This means that we give up the ability to generalize because our models are too sensitive to noise inherent in our data. Estimating parameters at the individual level is usually followed by a group-level statistical analysis. We might estimate the parameters of a signal detection or diffusion decision model for each participant individually, and then perform hypothesis tests on those parameters at the group level. For example, in a within-person design, we estimate individual bias parameters for each person in two conditions, and then perform a t-test at the group level to discover whether there is a difference between conditions. A problem that is associated with this approach is that we have to treat the estimated parameters as ‚Äúdata‚Äù at the group level, thus ignoring any uncertainty associated with those parameters; this can lead to over-confidence in our results. Nevertheless, this two-stage analysis is by far the most common approach in neuroscience.</p>
</section><section id="partial-pooling" class="level2"><h2 class="anchored" data-anchor-id="partial-pooling">Partial pooling</h2>
<p>A principled solution to the problems associated with individual and group level analyses is to use multilevel modelling. This allows us to simultaneously estimate group level parameters (fixed effects) and individual parameters (random effects) as deviations from the group average. This leads to the phenomenon known as <em>shrinkage</em>, which means that individual estimates are ‚Äúpulled‚Äù towards the group average, and are less susceptible to noise in the data. An intuitive way of thinking about this is that we are assuming that participants are all individuals, but they do share some common characteristics, and we can use information obtained from other participants to inform our estimates. This is what <em>partial pooling</em> refers to.</p>
<p>While multilevel models are outside the scope of this course, we will look some basic models in our final session on Baysian data analysis. The basic idea is that each individual participant‚Äôs parameters are treated as random draws from a group-level distribution, and the average effect is then simply the mean of that distribution.</p>
<div class="aside">
<p>Multilevel models do not have to be Bayesian - the can just as well be estimated using maximum likelihood estimation.</p>
</div>
</section><section id="frequentist-statistics" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="frequentist-statistics">Frequentist statistics</h2>
<p>The traditional approach to statistics is know as frequentist statistics. We will first go through the basic principles, then discuss some of the limitations associated with this approach, and then contrast this with the Bayesian approach.</p>
<p>In a traditional approach to statistics, students are usually taught a variety of different approaches (far too many to discuss here - there are enough enough different models to fill entire text books). In a nutshell, most of these approachs perform the following steps (I will use an equal-variance independent samples t-test as a running example, as well as the problem of estimating the probability of sucess parameter in a model of Bernoulli trials):</p>
<ol type="1">
<li>A statistical model is assumed. In the case of the t-test all observations within both groups are assumed to be normally distributed, with the groups differing in the means of the distributions (assuming that the standard deviations of both groups are equal to <span class="math inline">\(\sigma\)</span>).</li>
</ol>
<div class="page-columns page-full"><p><span class="math display">\[
y_{ij} \sim \mathcal{N}(\mu_j, \sigma^2)
\]</span> <span class="math inline">\(y_{ij}\)</span> refers to the <span class="math inline">\(i_{th}\)</span> observation in group <span class="math inline">\(j \in \{1, 2\}\)</span>. This observations are assumed to be independent random variates from a normal distribution (i.i.d)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, with the distribution‚Äôs mean <span class="math inline">\(\mu_j\)</span> depending on the group. In a t-test, we are interested in the difference between the group means, <span class="math inline">\(\mu_2 - \mu_1\)</span>.</p><div class="no-row-height column-margin column-container"><li id="fn1" role="doc-endnote"><p><sup>1</sup>&nbsp;independent and identically distributed</p></li></div></div>
<ol start="2" type="1">
<li><p>The group means are estimated. This can be done, e.g.&nbsp;using maximum likelihood estimation. You will be more familiar with the technique of ‚Äúsimply‚Äù using the sample means to estimate <span class="math inline">\(\mu_j\)</span>, which actually corresponds to the maximum likelihood estimate. The third parameter that has to be estimated is <span class="math inline">\(\sigma\)</span>. This is the <strong>parameter estimation</strong> step. <span class="math inline">\(\sigma\)</span> can be estimated using maximum likelihood, or simply ‚Äúcalculated‚Äù as the pooled standard deviation <span class="math inline">\(s_p\)</span>. In either case, the parameter is estimated.</p></li>
<li><p>A test statistic is calculated. In this case, the difference <span class="math inline">\(\mu_1 - \mu_2\)</span> is of interest, and using this difference, a test statistic is computed. The test statistic can be computed as</p></li>
</ol>
<p><span class="math display">\[
t = \frac{\bar{x_1} - \bar{x_2}}{s_p \sqrt{2/n}}
\]</span></p>
<p>where <span class="math inline">\(s_p \sqrt{2/n}\)</span> is the standard error of the difference. <span class="math inline">\(t\)</span> is assumed to follow a Student-t distribution (under the null hypothesis), and we can compute the probability of observing a test statistic (estimated from the data) that is at least as extreme (depending on the hypothesis) as the observed one (or rather the t value estimated from the actually observed data), under the assumption that the null hypothesis is true. This tail probability is known as a <em>p-value</em>.</p>
<section id="what-can-we-discover-with-nhst" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="what-can-we-discover-with-nhst">What can we discover with NHST?</h3>
<p>It is important to think about what exactly this approach can tell us. For instance, can we discover how probable the null hypothesis is? Can we ask how probable it is that the null hypothesis is false, and that therefore the alternative is true?</p>
<p>Unfortunately, the answer to both of these questions is <strong>no</strong>, we cannot.</p>
<p>This approach cannot tell us anything about probabilities of hypotheses - all that we can discover is how likely the data (as summarized by the parameters) are to have occured under the assumption that the null is true. In this case, how likely is the t value, given that there is no difference between the groups, or mathematically, <span class="math inline">\(\mu_1 - \mu_2 = 0\)</span>. A small p-value can tell us that the data are unlikely, but that is not really the question we are asking.</p>
<p>What we would like to know (intuitively) is how likely are our hypotheses <span class="citation" data-cites="wagenmakersPracticalSolutionPervasive2007">(<a href="#ref-wagenmakersPracticalSolutionPervasive2007" role="doc-biblioref">Wagenmakers 2007</a>)</span>. But this is something that frequentist statistics cannot tell us, by design. In the frequentist interpretation, a probability is the relative frequency of occurence of an event. Under this interpretation, a parameter does not have an associated probability distribution, and the question of how probable certain parameter values are is meaningless. In contrast, in Bayesian statistics, a probability is assumed to represent the degree of belief (either subjective or objective) that a certain parameter value is true. As an example, for a frequentist, talking about the probability that it will rain tomorrow is meaningless, because this is not an experiment that can be repeated infinitely many times. For a Bayesian, on the other hand, the probability of rain is merely an expression of belief, a summary of our state of knowledge.</p>
<div class="no-row-height column-margin column-container"><div id="ref-wagenmakersPracticalSolutionPervasive2007" class="csl-entry" role="doc-biblioentry">
Wagenmakers, Eric-Jan. 2007. <span>‚ÄúA Practical Solution to the Pervasive Problems of p Values.‚Äù</span> <em>Psychonomic Bulletin &amp; Review</em> 14 (5): 779‚Äì804. <a href="https://doi.org/10.3758/BF03194105">https://doi.org/10.3758/BF03194105</a>.
</div></div></section></section><section id="problems-with-nhst" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="problems-with-nhst">Problems with NHST</h2>
<p>Even scientists routinely mistake p-values for probabilities of hypotheses. This is actually one of the most common misconceptions, and lead <span class="citation" data-cites="wassersteinASAStatementPValues2016">Wasserstein and Lazar (<a href="#ref-wassersteinASAStatementPValues2016" role="doc-biblioref">2016</a>)</span> to write a <em>Statement on Statistical Significance and P-Values</em> in the American Statistical Association. They clarify:</p>
<div class="no-row-height column-margin column-container"><div id="ref-wassersteinASAStatementPValues2016" class="csl-entry" role="doc-biblioentry">
Wasserstein, Ronald L., and Nicole A. Lazar. 2016. <span>‚ÄúThe <span>ASA Statement</span> on p-<span>Values</span>: <span>Context</span>, <span>Process</span>, and <span>Purpose</span>.‚Äù</span> <em>The American Statistician</em> 70 (2): 129‚Äì33. <a href="https://doi.org/10.1080/00031305.2016.1154108">https://doi.org/10.1080/00031305.2016.1154108</a>.
</div></div><ul>
<li>P-values can indicate how incompatible the data are with a specified statistical model.</li>
<li>P-values do not measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone.</li>
<li>Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.</li>
</ul>
<p>A further complication is that the commonly used threshold <span class="math inline">\(p = 0.05\)</span> is completely arbitrary, and based on a combination of ideas by Fisher and Pearson/Neyman. The modern usage actually reflects neither approaches, and is often considered to be a bit of a mess <span class="citation" data-cites="amrheinScientistsRiseStatistical2019">(<a href="#ref-amrheinScientistsRiseStatistical2019" role="doc-biblioref">Amrhein, Greenland, and McShane 2019</a>)</span>. <span class="citation" data-cites="gigerenzerMindlessStatistics2004">Gigerenzer (<a href="#ref-gigerenzerMindlessStatistics2004" role="doc-biblioref">2004</a>)</span>;<span class="citation" data-cites="gigerenzerStatisticalRitualsReplication2018a">Gigerenzer (<a href="#ref-gigerenzerStatisticalRitualsReplication2018a" role="doc-biblioref">2018</a>)</span> provides an interesting comment on modern usage of hypothesis testing.</p>
<div class="no-row-height column-margin column-container"><div id="ref-amrheinScientistsRiseStatistical2019" class="csl-entry" role="doc-biblioentry">
Amrhein, Valentin, Sander Greenland, and Blake McShane. 2019. <span>‚ÄúScientists Rise up Against Statistical Significance.‚Äù</span> <em>Nature</em> 567 (7748, 7748): 305‚Äì7. <a href="https://doi.org/10.1038/d41586-019-00857-9">https://doi.org/10.1038/d41586-019-00857-9</a>.
</div><div id="ref-gigerenzerMindlessStatistics2004" class="csl-entry" role="doc-biblioentry">
Gigerenzer, Gerd. 2004. <span>‚ÄúMindless Statistics.‚Äù</span> <em>The Journal of Socio-Economics</em> 33 (5): 587‚Äì606. <a href="https://doi.org/10.1016/j.socec.2004.09.033">https://doi.org/10.1016/j.socec.2004.09.033</a>.
</div><div id="ref-gigerenzerStatisticalRitualsReplication2018a" class="csl-entry" role="doc-biblioentry">
‚Äî‚Äî‚Äî. 2018. <span>‚ÄúStatistical <span>Rituals</span>: <span>The Replication Delusion</span> and <span>How We Got There</span>.‚Äù</span> <em>Advances in Methods and Practices in Psychological Science</em> 1 (2): 198‚Äì218. <a href="https://doi.org/10.1177/2515245918771329">https://doi.org/10.1177/2515245918771329</a>.
</div></div><p>Apart from not being particularly intuitive and not allowing us to adress the questions we would like to answer, NHST also has the problem that incentive structures in scientific publishing can often lead to misapplications of NHST procedures. Various questionable research practices are associated with this, including <em>p-hacking</em>. This refers to the practice of performing multiple significance tests, and selecting only those that yield significant results for reporting. In other words - NHST, if used correclty, can be a very useful tool. A big problem is that it os often not used correctly, and this can lead to misleading results.</p>
</section><section id="case-studies" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="case-studies">Case studies</h2>
<p>We will briefly explore the frequentist approach to data analysis using two examples:</p>
<ol type="1">
<li>an independent samples t-test, and</li>
<li>the card game from the previous chapter, and</li>
</ol>
<section id="sec-fancyhat" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="sec-fancyhat">T-test</h3>
<p>This example uses simulated data, but is based on an actual study. In the code below, we simulate creativity scores from two groups. One group was instructed to wear a fancy hat, the other, woth no head gear, serves as a control group. We would like to know whether the fancy hat group and the control group differ in their mean creativity.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>

<span class="co"># Number of people wearing fancy hats</span>
<span class="va">N_fancyhats</span> <span class="op">&lt;-</span> <span class="fl">50</span> 

<span class="co"># Number of people not wearing fancy hats</span>
<span class="va">N_nofancyhats</span> <span class="op">&lt;-</span> <span class="fl">50</span>

<span class="co"># Population mean of creativity for people wearing fancy hats</span>
<span class="va">mu_fancyhats</span> <span class="op">&lt;-</span> <span class="fl">103</span> 

<span class="co"># Population mean of creativity for people wearing no fancy hats</span>
<span class="va">mu_nofancyhats</span> <span class="op">&lt;-</span> <span class="fl">98</span> 

<span class="co"># Average population standard deviation of both groups</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">15</span> 

<span class="co"># Generate data</span>
<span class="va">fancyhats</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Creativity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N_fancyhats</span>, <span class="va">mu_fancyhats</span>, <span class="va">sigma</span><span class="op">)</span>,
               Group <span class="op">=</span> <span class="st">"Fancy Hat"</span><span class="op">)</span>

<span class="va">nofancyhats</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Creativity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N_nofancyhats</span>, <span class="va">mu_nofancyhats</span>, <span class="va">sigma</span><span class="op">)</span>,
                 Group <span class="op">=</span> <span class="st">"No Fancy Hat"</span><span class="op">)</span>


<span class="va">FancyHat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">fancyhats</span>, <span class="va">nofancyhats</span><span class="op">)</span>  |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span>, <span class="st">"No Fancy Hat"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have created a dataframe called <code>FancyHat</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">FancyHat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 √ó 2
   Creativity Group    
        &lt;dbl&gt; &lt;fct&gt;    
 1       80.8 Fancy Hat
 2      127.  Fancy Hat
 3       88.6 Fancy Hat
 4       89.2 Fancy Hat
 5       73.0 Fancy Hat
 6       98.9 Fancy Hat
 7       98.3 Fancy Hat
 8       93.6 Fancy Hat
 9      101.  Fancy Hat
10      109.  Fancy Hat
# ‚Ä¶ with 90 more rows</code></pre>
</div>
</div>
<p>We can now pretend that we don‚Äôt know how the data were generated, and treat them as data from an experiment.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">FancyHat</span> |&gt; 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Creativity</span>, x <span class="op">=</span> <span class="va">Group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Box Plot of Creativity Values"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Assuming that both groups are normally distributed with the same variance, we can use the t-test to determine whether the mean of the two groups is different.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fancyhat_ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Creativity</span> <span class="op">~</span> <span class="va">Group</span>,
       var.equal <span class="op">=</span> <span class="cn">TRUE</span>,
       data <span class="op">=</span> <span class="va">FancyHat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fancyhat_ttest_tab</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fancyhat_ttest</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fancyhat_ttest_tab</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="va">estimate1</span>, <span class="va">estimate2</span>, <span class="va">statistic</span>, <span class="va">p.value</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 7
  estimate estimate1 estimate2 statistic p.value conf.low conf.high
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1    -1.65      99.2      101.    -0.637   0.526    -6.78      3.49</code></pre>
</div>
</div>
<p>It might not be obvious at first glance what we have done here:</p>
<ol type="1">
<li>We assumed that the data are conditionally normally distributed, given the means, with the same variance.</li>
</ol>
<p><span class="math display">\[
y_{ij} \sim \mathcal{N}(\mu_j, \sigma^2)
\]</span></p>
<ol start="2" type="1">
<li><p>we estimated three parameters: <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, and <span class="math inline">\(\sigma\)</span>.</p></li>
<li><p>We computed the difference between groups as <span class="math inline">\(\mu_1 - \mu_2\)</span>. This gives us an estimate of the difference between the means <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p></li>
<li><p>We compute a test statistic (empirical t value)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p></li>
<li><p>We computed the probability of observing the observed difference divided by the standard error, under the null hypothesis that the means are the same (<span class="math inline">\(\mu_1 = \mu_2\)</span>)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. This is a two-sided test, i.e.&nbsp;we have no hypothesis as to which group has the larger mean.</p></li>
</ol>
<div class="no-row-height column-margin column-container"><li id="fn2" role="doc-endnote"><p><sup>2</sup>&nbsp;<code>estimate1</code> und <code>estimate2</code></p></li><li id="fn3" role="doc-endnote"><p><sup>3</sup>&nbsp;<code>estimate</code></p></li><li id="fn4" role="doc-endnote"><p><sup>4</sup>&nbsp;<code>statistic</code></p></li><li id="fn5" role="doc-endnote"><p><sup>5</sup>&nbsp;<code>p.value</code></p></li></div><div class="callout-tip callout callout-style-default callout-captioned page-columns page-full">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body page-columns page-full">
<div class="page-columns page-full"><p>What does the p-value tell us? Does it tell you what you want to know? Do you know what the confidence interval tells you <a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>?</p><div class="no-row-height column-margin column-container"><li id="fn6" role="doc-endnote"><p><sup>6</sup>&nbsp;<code>conf.low</code> and <code>conf.high</code></p></li></div></div>
<p>The p-value is 0.53 This is larger that the conventional threshold <span class="math inline">\(\alpha=0.05\)</span>. What does this mean?</p>
</div>
</div>
</section><section id="card-game" class="level3"><h3 class="anchored" data-anchor-id="card-game">Card game</h3>
<p>Two players are playing a game of cards. You observe that they play 9 games, and that player A wins 6 of those. Now you would like to estimate the probability that player A will win the next game. Another way of putting it that you would to estimate the ability of player A to beat player B at this particular game.</p>
<p>You know that the probability of success must lie in the range <span class="math inline">\([0, 1]\)</span>. What you might not be aware of is that you are assuming a certain probability model, and the probability of success is a parameter of that model. Let‚Äôs take a closer look:</p>
<p>We know that the number of <span class="math inline">\(k\)</span> successes in <span class="math inline">\(n\)</span> games follows a binomial distribution with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(\theta\)</span>. To make things simpler, we also know that each individual game is independent of the others, and the probability of success <span class="math inline">\(\theta\)</span> is the same for each game. Each success therefore follows a Bernoulli distribution with parameter <span class="math inline">\(\theta\)</span>.</p>
<p><span class="math display">\[
y_i \sim \mathcal{Bernoulli}(\theta)
\]</span></p>
<div class="{callout-tip}">
<p>I will generally use the notation <span class="math inline">\(y\)</span> for a variable that is observed, i.e.&nbsp;the data.</p>
</div>
<p><span class="math inline">\(y_i\)</span> is the <span class="math inline">\(i\)</span> th observation in the data, meaning that it tells us whether player A won the game or not on trial <span class="math inline">\(i\)</span>. <span class="math inline">\(\theta\)</span> is the probability of success for each individual game; this is a parameter of our model (<span class="math inline">\(\mathcal{M}\)</span>).</p>
<p>Previously, we used maximum likelihood to estimate <span class="math inline">\(\theta\)</span> - we will repeat this briefly here.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">wins</span> <span class="op">&lt;-</span> <span class="fl">6</span>
<span class="va">games</span> <span class="op">&lt;-</span> <span class="fl">9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The goal is to figure out the ‚Äúbest‚Äù value of <span class="math inline">\(\theta\)</span>, i.e.&nbsp;the value that maximizes the likelihood of observing the data. To do this, we need to consider a range of possible values of <span class="math inline">\(\theta\)</span> (we already know that this range is <span class="math inline">\([0, 1]\)</span>, so that part is easy). We will consider 101 values of <span class="math inline">\(\theta\)</span> between 0 and 1, and compute the likelihood of observing the data for each value of <span class="math inline">\(\theta\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">n_points</span> <span class="op">&lt;-</span> <span class="fl">101</span>
<span class="va">theta_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span> from<span class="op">=</span><span class="fl">0</span> , to<span class="op">=</span><span class="fl">1</span> , length.out <span class="op">=</span> <span class="va">n_points</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assuming that both players have an equal chance of winning, the parameter should be <span class="math inline">\(\theta = 0.5\)</span>. The probability of the data given <span class="math inline">\(\theta = 0.5\)</span> is:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wins</span>, size <span class="op">=</span> <span class="va">games</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1640625</code></pre>
</div>
</div>
<p>The probability of winning 6 out of 9 games, given that both players are equally likely to win, is 0.1640625.</p>
<p>We can also compute the probability of A winning 6, 7, 8 or 9 games, using the cumulative distribution function of the binomial distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="va">games</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2539063</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="va">games</span>, prob <span class="op">=</span> <span class="fl">0.5</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2539063</code></pre>
</div>
</div>
<div class="aside">
<p><code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> gives us the lower tail probability, which is the probability that the number of successes is less than or equal to the given value, by default.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
p-value
</div>
</div>
<div class="callout-body-container callout-body">
<p>Does this seem familiar?</p>
<p>If we want to quantify our <em>null</em> hypothsis that both players are equally likely to win, we would assume that <span class="math inline">\(\theta=0.5\)</span>. Computing the probability of the data under the null is exactly what we have just done. We then plug in the actual data, i.e.&nbsp;6 out of 9, and the upper tail probability is the p-value. In this case, the p-value is approximately <span class="math inline">\(0.25\)</span>. Using cut-off of 0.05, we would not reject the null hypothesis, and conclude that there is not enough evidence that player A is better than player B (this is a one-sided test).</p>
</div>
</div>
<p>Now we compute the probability of the data under all parameter values under consideration. In R, this is very simple, since all functions are vectorized.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">wins</span> , size <span class="op">=</span> <span class="va">games</span> , prob <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see in the above figure that the probability of observing the data is small for a lot of values of <span class="math inline">\(\theta\)</span>. The probability of observing the data, or the likelihood, is maximal for the value 0.6666667:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">theta_grid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span><span class="op">]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.67</code></pre>
</div>
</div>
<p>What we have done so far highlights the distinction between parameter estimation and hypothesis testing. Computing the tail probability under the null (<span class="math inline">\(\theta=0.5\)</span>) is a hypothesis test, and estimating <span class="math inline">\(\theta\)</span> is parameter estimation.</p>
</section></section><section id="an-introduction-to-bayesian-inference" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="an-introduction-to-bayesian-inference">An introduction to Bayesian inference</h2>
<div class="page-columns page-full"><p>So far, we haven‚Äôt considered any prior knowledge we might have had about which parameters are the most likely a priori. In fact, as we will see a bit further down, we have implicitly assumed that all parameters are equally likely. We will now introduce a new concept: a prior distribution for the parameter(s) we are trying to estimate<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn7" role="doc-endnote"><p><sup>7</sup>&nbsp;In frequentist statistics, the concept is meaningless - parameters cannot have distribution. In Bayesian statistics, a prior distribution should reflect everything we know about the parameter, before we consider the data. The prior reflects our belief, which can be subjective, or objective.</p></li></div></div>
<p>We will then use that <strong>prior</strong> belief in order to obtain a <strong>posterior</strong> belief over the possible parameter values. To do this, we need to multiply the prior probability of each parameter value by the likelihood of the data, i.e.&nbsp;by the probability of observing the data given that parameter value. This is an application of Bayes theorem:</p>
<p><span class="math display">\[
p(\theta|y) = \frac{ p(y|\theta) * p(\theta) } {p(y)}
\]</span></p>
<p>This states that the posterior probability of <span class="math inline">\(\theta\)</span> given the observed data <span class="math inline">\(y\)</span> is equal to the probability of the data, multiplied by how probable each value of <span class="math inline">\(\theta\)</span> is a priori. You can think of it like this: each parameter value is weighted according to how well it predicts the data. The product <span class="math inline">\(p(y|\theta) * p(\theta)\)</span> is then divided by the probability of the data, which in this case is summed over all possible parameter values. This step serves to normalize the posterior, so that it sums to <span class="math inline">\(1\)</span>. This essentially turns the unnormalized posterior into a proper probability distribution.</p>
<p><span class="math display">\[
p(y) = \sum_{\theta}p(y|\theta) * p(\theta)
\]</span></p>
<p>When we are interested in estimating the parameters of a given model, we can often neglect the (constant for a model) normalizing term <span class="math inline">\(p(y)\)</span>. This term, often called the evidence, reflects the probability of the data, averaged over all parameter values. Written without the normalizing constant, Bayes rule is often written as:</p>
<p><span class="math display">\[
p(\theta|y) \propto  p(y|\theta) * p(\theta)
\]</span></p>
</section><section id="recap" class="level2"><h2 class="anchored" data-anchor-id="recap">Recap</h2>
<p>Bayesian inference, in a nutshell, consists of:</p>
<ol type="1">
<li><p>Represent your prior belief by a probability distribution over the possible parameter values. This is a principled way of dealing with uncertainty.</p></li>
<li><p>Use the likelihood to weight the prior belief.</p></li>
<li><p>Obtain a posterior belief over the possible parameter values.</p></li>
</ol>
<div class="aside">
<p>The term <em>belief</em> is used synonymously with <em>probability distribution</em>.</p>
</div>
</section><section id="bayesian-inference-in-the-card-game-a-numerical-example" class="level2"><h2 class="anchored" data-anchor-id="bayesian-inference-in-the-card-game-a-numerical-example">Bayesian inference in the card game: a numerical example</h2>
<p>Recall that we defined a sequence of 101 points between 0 and 1, which represented the possible <span class="math inline">\(\theta\)</span> values.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">n_points</span> <span class="op">&lt;-</span> <span class="fl">101</span>
<span class="va">theta_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span> from<span class="op">=</span><span class="fl">0</span> , to<span class="op">=</span><span class="fl">1</span> , length.out <span class="op">=</span> <span class="va">n_points</span> <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each of these, we computed the likelihood, that is the probability of observing the (fixed) data, given the parameter. Now, we can make our knowledge about the probability of each parameter value explicit. At first, we will assume that all parameters are equally likely. We will assign the probability of 1 to each parameter value. This is our prior distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">theta_grid</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span>, <span class="va">prior_1</span>, <span class="st">"type"</span> <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We could also express the belief that player is at least as good as player B, i.e.&nbsp;they are equally good or A is better than B. One way of doing this is to assign a probability of <span class="math inline">\(1\)</span> to parameter values greater than or equal to <span class="math inline">\(0.5\)</span>, and the value <span class="math inline">\(0\)</span> to parameter values less than <span class="math inline">\(0.5\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">theta_grid</span> <span class="op">&lt;</span> <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span>, <span class="va">prior_2</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A more systematic way of doing this is to use a parameterized probability distribution that expresses our beliefs about the parameter.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A family of probability distributions that are suitable for parameters that lie in the interval <span class="math inline">\([0,1]\)</span> is the <a href="https://en.wikipedia.org/wiki/Beta_distribution">Beta distribution</a>. This distribution has <span class="math inline">\(2\)</span> parameters <span class="math inline">\(\alpha\)</span> und <span class="math inline">\(\beta\)</span>, which can be interpreted as the prior number of successes and the number of failures, respectively. The number of trials is therefore <span class="math inline">\(\alpha + \beta\)</span>. <span class="citation" data-cites="ref">(<a href="#ref-ref" role="doc-biblioref"><strong>ref?</strong></a>)</span>(fig:betadist) shows a number of possible Beta distributions for various settings of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="va">length</span> <span class="op">&lt;-</span> <span class="fl">1e4</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,
           shape2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">expand</a></span><span class="op">(</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">nesting</a></span><span class="op">(</span><span class="va">shape1</span>, <span class="va">shape2</span><span class="op">)</span>,
         x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">length</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"a = "</span>, <span class="va">shape1</span><span class="op">)</span>,
         b <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"b = "</span>, <span class="va">shape2</span><span class="op">)</span>,
         group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">length</span>, each <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">d</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, shape1 <span class="op">=</span> <span class="va">shape1</span>, shape2 <span class="op">=</span> <span class="va">shape2</span><span class="op">)</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"steelblue4"</span>, size <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Beta distributions"</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">p</span><span class="op">(</span><span class="va">theta</span><span class="op">*</span><span class="st">"|"</span><span class="op">*</span><span class="va">a</span><span class="op">*</span><span class="st">", "</span><span class="op">*</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">b</span><span class="op">~</span><span class="va">a</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>If we want to use a Beta distribution to express the belief that all values of <span class="math inline">\(\theta\)</span> are equally likely (uniform prior), we can a Beta distribution with <span class="math inline">\(\alpha = 1\)</span> and <span class="math inline">\(\beta = 1\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span>, <span class="va">prior_3</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, we could express the following prior information as a Beta distribution: imagine you had previously observed <span class="math inline">\(100\)</span> games between A and B, and each won half of the games. You can set <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to the number of games won by A, and the number of games won by B, respectively. A won <span class="math inline">\(50\)</span>, and B won <span class="math inline">\(50\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">50</span>, shape2 <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span>, <span class="va">prior</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, we can combine the prior and the likelihood by multiplying them element-wise, i.e.&nbsp;we need to multiply each parameter value with the probability of the data given that parameter.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recall Bayes theorem:</p>
<p><span class="math display">\[
p(\theta|y) = \frac{ p(y|\theta) * p(\theta) } {p(y)}
\]</span></p>
</div>
</div>
<p>In R, this is simply:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">wins</span> <span class="op">&lt;-</span> <span class="fl">6</span>
<span class="va">games</span> <span class="op">&lt;-</span> <span class="fl">9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">4</span>, shape2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">wins</span> , size <span class="op">=</span> <span class="va">games</span> , prob <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">unstandardized_posterior</span> <span class="op">&lt;-</span> <span class="va">likelihood</span> <span class="op">*</span> <span class="va">prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us the unnormalized posterior:</p>
<p><span class="math display">\[
p(\theta|y) \propto  p(y|\theta) * p(\theta)
\]</span></p>
<p>We can then normalize the posterior distribution by dividing it by <span class="math inline">\(p(y) = \sum_{\theta}p(y|\theta) * p(\theta)\)</span>.</p>
<p>In R we can use the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> function: <code>sum(unstandardized_posterior)</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="va">unstandardized_posterior</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">unstandardized_posterior</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now plot the resulting normalized posterior distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span>, <span class="va">posterior</span>, type <span class="op">=</span> <span class="st">"l"</span>, yaxt <span class="op">=</span> <span class="st">'n'</span>, ylab <span class="op">=</span> <span class="st">'Probability'</span>, 
        main <span class="op">=</span> <span class="st">"Posterior"</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.main <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To make this repeatable, we will write two functions. The first, <code>compute_posterior()</code>, will compute the posterior, given the prior and likelihood, and return a dataframe containing prior, likelihood and posterior. The second, <code>plot_posterior()</code>, will plot all three side-by-side. You can also pass in the maximum likelihood estimate, e.g.&nbsp;<code>6/9</code>, and this will be plotted as well.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">compute_posterior</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># compute product of likelihood and prior</span>
  <span class="va">unstandardized_posterior</span> <span class="op">&lt;-</span> <span class="va">likelihood</span> <span class="op">*</span> <span class="va">prior</span>
  
  <span class="co"># standardize the posterior, so it sums to 1</span>
  <span class="va">posterior</span> <span class="op">&lt;-</span> <span class="va">unstandardized_posterior</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">unstandardized_posterior</span><span class="op">)</span>
  
  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">prior</span>, <span class="va">likelihood</span>, <span class="va">posterior</span><span class="op">)</span>
  <span class="va">out</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">plot_posterior</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">mle</span> <span class="op">=</span> <span class="fl">6</span><span class="op">/</span><span class="fl">9</span><span class="op">)</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span> , <span class="va">prior</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">"Prior"</span>, col <span class="op">=</span> <span class="st">"dodgerblue3"</span>, 
            lwd <span class="op">=</span> <span class="fl">4</span>, yaxt <span class="op">=</span> <span class="st">'n'</span>, ylab <span class="op">=</span> <span class="st">'Probability'</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.main <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span> , <span class="va">likelihood</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Likelihood"</span>, col <span class="op">=</span> <span class="st">"firebrick3"</span>, 
            lwd <span class="op">=</span> <span class="fl">4</span>, yaxt <span class="op">=</span> <span class="st">'n'</span>, ylab <span class="op">=</span> <span class="st">''</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.main <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span> , <span class="va">posterior</span> , type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Posterior"</span>, col <span class="op">=</span> <span class="st">"darkorchid3"</span>, 
            lwd <span class="op">=</span> <span class="fl">4</span>, yaxt <span class="op">=</span> <span class="st">'n'</span>, ylab <span class="op">=</span> <span class="st">''</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.main <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">mle</span>, col <span class="op">=</span> <span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span> <span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can now try out various prior distributions, and observe the effect on the posterior.</p>
<p>Let‚Äôs try out a uniform prior first:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">wins</span> , size <span class="op">=</span> <span class="va">games</span> , prob <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">compute_posterior</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">plot_posterior</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this case, the maximum likelihood estimate coincides with the value that maximizes the posterior probability. This is the case because maximum likelihood estimate uses only the likelihood and does not consider prior knowledge. If we are are using a uniform prior, that amounts to saying that all values of <span class="math inline">\(\theta\)</span> are equally likely. In other words, we have no information as which values are more probable.</p>
</div>
</div>
<p>Now let‚Äôs try out our prior expressing the belief that player A cannot be worse than player B:</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">theta_grid</span> <span class="op">&lt;</span> <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">wins</span> , size <span class="op">=</span> <span class="va">games</span> , prob <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">compute_posterior</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">plot_posterior</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The resulting posterior distribution is zero for all values of <span class="math inline">\(\theta\)</span> that are less than 0.5. This is because our prior allocates zero probability those values.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try out various priors. How do they affect the posterior?</p>
<ul>
<li>A prior expressing the belief that B is better than A.</li>
<li>A prior expressing that belief that either A is a lot better, or B is a lot better.</li>
<li>A prior expressing the belief that the players are probably as good as each other, and that it is unlikely that either is much better than the other.</li>
</ul>
</div>
</div>
<p>The posterior represents our belief about the the possible parameter values, after having observed the data. You can therefore think of Bayesian inference as a method for updating your beliefs, conditional on observed data. You are re-allocating probabilities over parameter values, depending on how well those parameter values predicted the data.</p>
</section><section id="analytic-solution-for-the-bernoullibinomial-likelihood-and-beta-prior" class="level2"><h2 class="anchored" data-anchor-id="analytic-solution-for-the-bernoullibinomial-likelihood-and-beta-prior">Analytic solution for the Bernoulli/Binomial likelihood and Beta prior</h2>
<p>In the above example, we used a technique called grid approximation to obtain the posterior distribution for a parameter. This means that we tried out various parameter values by constructing a grid, and then computed the posterior by applying Bayes‚Äô rule. This technique was used merely for educational purposes, as it does not scale well to real-world problems. In the simple example of a sequence of binary observations, the parameter of interest (the probability of success <span class="math inline">\(\theta\)</span> in a Bernoulli trial) is bounded between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (<span class="math inline">\(\theta \in [0, 1]\)</span>). Furthermore, there is only <span class="math inline">\(1\)</span> parameter to estimate. In more complex models, with many parameters, using grid approximation can be very inefficient, or even impossible. In such cases, we usually use numerical methods to approximate the posterior distribution. These methods are know collectively as <em>Monte Carlo sampling</em>, or <em>Markov Chain Monte Carlo</em> (MCMC). Using MCMC, we will not obtain an analytical description of posterior distributions, but instead a collection of random numbers (samples), that are drawn from the posterior distribution. We will use these samples to represent the posterior distribution.</p>
<p>In this particular case, however, we also obtain the posterior distribution <span class="math inline">\(p(\theta|y)\)</span> analytically. By this, I mean that if we use a Beta distribution to describe our prior belief over the <span class="math inline">\(\theta\)</span> parameter, and the likelihood is Bernoulli or Binomial, the posterior distribution is also a Beta distribution.</p>
<p>This is shown here for the Binomial likelihood:</p>
<p><span class="math display">\[
p(\theta|z, N) = \frac{p(y|\theta) \cdot p(\theta) = \theta^z (1-\theta)^{N-z} \cdot beta(\theta|a, b)}{p(z, N)}
\]</span></p>
<p>where <span class="math inline">\(z\)</span> is the number of successes, <span class="math inline">\(N\)</span> is the number of trials, and <span class="math inline">\(a, b\)</span> are the parameters of the Beta distribution.</p>
<p><span class="math display">\[
p(\theta|a, b) = beta(\theta|a, b) = \frac{\theta^{a-1} (1-\theta)^{b-1}} {B(a, b)}
\]</span></p>
<p>The function <span class="math inline">\(B(a, b)\)</span> is a normalizing constant and ensures that the area under the curve integrates to <span class="math inline">\(1\)</span>.</p>
<p><span class="math display">\[
p(\theta|z, N) = \frac{\theta^{(a+z)-1} (1-\theta)^{(b+N-z)-1}} { B(a+z, b+N-z) }
\]</span></p>
<p>Put more simply:</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the prior distribution is <span class="math inline">\(beta(\theta|a, b)\)</span>, and the data have <span class="math inline">\(z\)</span> heads in <span class="math inline">\(N\)</span> flips, then the posterior distribution is <span class="math inline">\(beta(\theta|a + z, b + N ‚àí z)\)</span>.</p>
</div>
</div>
<p>You can therefore think of the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> as the prior successes and failures in <span class="math inline">\(N\)</span> trials, and these parameters are updated by observing <span class="math inline">\(z\)</span> heads in <span class="math inline">\(N\)</span> flips.</p>
<section id="example" class="level3"><h3 class="anchored" data-anchor-id="example">Example</h3>
<p>This time, we are using <code>theta_grid</code> merely so we can plot the prior and posterior. Suppose that we have observed 8 games, and that player A has won 4 of those. Our prior should therefore be <span class="math inline">\(p(\theta|4,4)\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">4</span>, shape2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">theta_grid</span>, <span class="va">prior</span>, <span class="st">"l"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If we now observe that player A wins 3 out of the next 4 games, our posterior should be <span class="math inline">\(p(\theta|4+3,4+1)\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">7</span>, shape2 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">prior</span>, 
       posterior <span class="op">=</span> <span class="va">posterior</span>, 
       theta <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prior</span>, <span class="va">posterior</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"distribution"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can write a function that updates a Beta prior, given <span class="math inline">\(k\)</span> successes in <span class="math inline">\(N\)</span> trials:</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">update_beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">k</span>, <span class="va">N</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">theta_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">101</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">k</span>, shape2 <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="va">N</span><span class="op">-</span><span class="va">k</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu">update_beta</span><span class="op">(</span>a <span class="op">=</span> <span class="fl">4</span>, b <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">3</span>, N <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">prior</span>, 
       posterior <span class="op">=</span> <span class="va">posterior</span>, 
       theta <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prior</span>, <span class="va">posterior</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"distribution"</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="summarizing-the-posterior" class="level2"><h2 class="anchored" data-anchor-id="summarizing-the-posterior">Summarizing the posterior</h2>
<p>We now need one last step: we need to summarize the posterior distribution. We can do this, for example by computing the mean and standard deviation of the posterior distribution.</p>
<p>To show how this works, we can draw a thousand samples from the posterior distribution. First, we‚Äôll create a posterior.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta_grid</span>, shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">wins</span>, size <span class="op">=</span> <span class="va">games</span> , prob <span class="op">=</span> <span class="va">theta_grid</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">compute_posterior</span><span class="op">(</span><span class="va">likelihood</span>, <span class="va">prior</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">plot_posterior</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11_data-analysis-1_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we‚Äôll draw 1000 random numbers from the posterior.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">1e3</span>

<span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">theta_grid</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">n_samples</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">posterior</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">samples</span>, <span class="fl">10</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.33 0.71 0.56 0.84 0.35 0.53 0.72 0.66 0.77 0.72</code></pre>
</div>
</div>
<p>Now we can summarize the samples, e.g.&nbsp;by computing the mean or quantiles.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.63476</code></pre>
</div>
</div>
<p>The following will give us the median, and a 50% <strong>credible interval</strong>, i.e.&nbsp;an interval that contains 50% of the mass of the distribution.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 25%  50%  75% 
0.54 0.64 0.74 </code></pre>
</div>
</div>
<p>We can also use this approach to compute a 95% credible interval.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>

<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 2.5% 97.5% 
 0.36  0.87 </code></pre>
</div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This should not be confused with the 95% confidence interval. Can you remember how a confidence interval is defined? What is the difference between a confidence interval and a credible interval?</p>
</div>
</div>
<p>What we have done so far is to look at Bayesian inference for parameter estimation (in a very simple model). Let‚Äôs call this model <span class="math inline">\(\mathcal{M}\)</span>. We have only considered one model at a time, but in the next session we will consider two or models $, which differ in the prior distributions they use. We will then look at methods for comparing models, in order to perform hypothesis testing in a Bayesian framework.</p>
<p>In particular, we will look at how Bayesian model comparison can help, in the case that we have no significant results (see <a href="#sec-fancyhat">Section&nbsp;7.1</a>).</p>


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{ellis2022,
  author = {Andrew Ellis},
  title = {Data Analysis: {I}},
  date = {2022-05-10},
  url = {https://kogpsy.github.io/neuroscicomplabFS22//pages/chapters/11_data-analysis-1.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-ellis2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Andrew Ellis. 2022. <span>‚ÄúData Analysis: I.‚Äù</span> May 10, 2022. <a href="https://kogpsy.github.io/neuroscicomplabFS22//pages/chapters/11_data-analysis-1.html">https://kogpsy.github.io/neuroscicomplabFS22//pages/chapters/11_data-analysis-1.html</a>.
</div></div></section></div></main><!-- /main --><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb64" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Data analysis: I"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> | </span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Combining informatin from multiple participants | Intro to Bayesian data anlysis.</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2022-05-10"</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Andrew Ellis</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://github.com/awellis</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universit√§t Bern </span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation-url: https://www.kog.psy.unibe.ch</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0002-2788-936X</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="an">license:</span><span class="co"> CC BY</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> ../../bibliography.bib</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co">    html:</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co">        toc: true</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co">        code-link: true</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co">        code-fold: false</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co">        code-tools: true</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- :::{.callout-note} --&gt;</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- üëâ [R Code f√ºr dieses Kapitel downloaden](../../downloadable_files/evidence-accumulation-1.R) --&gt;</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: --&gt;</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- t-test --&gt;</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     - Lee --&gt;</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Signal detection --&gt;</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     - Lee --&gt;</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     - Farrell --&gt;</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-packages</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data analysis</span></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>In this chapter, we will tackle two important topics: </span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>1) What methods should we use when modelling and summarizing data from multiple participants, and </span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>2) Which alternative approaches are available when methods for null hypothesis significance testing (NHST) are not suitable. </span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>The latter is often the case in neuroscience, where low power due to small sample sizes is a well-known problem <span class="co">[</span><span class="ot">@buttonPowerFailureWhy2013</span><span class="co">]</span>. The alternative approach we will discuss here is Bayesian data analysis, which also has the benefit is allowing us to provide evidence _for_ or _against_ hypotheses, something which is not possible using NHST. </span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelling and summarizing data from multiple participants</span></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a>In most neuroscience experiments, we are interested in effects of manipulations at the individual level, but we also need to be sure that theses effects hold at the group level, and are not particular to certain individuals. However, reporting effects at the group level is not straightforward.In short, there are three possiblities </span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>when combining informatin from multiple participants:</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### Complete pooling</span></span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>We can pretend that all our data come from 1 participant, by averaging over participants. In statistics, this is know as  _complete pooling_, meaning that all data are pooled and we are no longer interested in individual participants. The pooled data are then used to estimate parameters, and to perfom hypothesis testing. While there are cases in which it is possible to analyze averaged data, in general this approach can lead to errors, and needs to be treated with care. A classic example is shown in @fig-power-law. The thin solid lines represent individual learning curves. Each indivdial appears to learn very rapidly (and linearly), but there is a huge variation in the onset of learning. The filled circles represent a naive attempt at averaging over all individuals. The result suggests that learning is gradual and starts from the outset; however the average learning curve looks nothing like the individual learning curves. This type of analysis can lead to erroneous conclusions.</span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a><span class="al">![Learning curves](../../assets/images/aggregating-power-law.png)</span>{#fig-power-law}</span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## No pooling</span></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>This means that data we estimate parameters of our models for each participant separately. While this appears to be a more sensible approach, there is the danger of over-fitting. This means that we give up the ability to generalize because our models are too sensitive to noise inherent in our data. Estimating parameters at the individual level is usually followed by a group-level statistical analysis. We might estimate the parameters of a signal detection or diffusion decision model for each participant individually, and then perform hypothesis tests on those parameters at the group level. For example, in a within-person design, we estimate individual bias parameters for each person in two conditions, and then perform a t-test at the group level to discover whether there is a difference between conditions. A problem that is associated with this approach is that we have to treat the estimated parameters as "data" at the group level, thus ignoring any uncertainty associated with those parameters; this can lead to over-confidence in our results. Nevertheless, this two-stage analysis is by far the most common approach in neuroscience.</span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## Partial pooling</span></span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a>A principled solution to the problems associated with individual and group level analyses is to use multilevel modelling. This allows us to simultaneously estimate group level parameters (fixed effects) and individual parameters (random effects) as deviations from the group average. This leads to the phenomenon known as _shrinkage_, which means that individual estimates are "pulled" towards the group average, and are less susceptible to noise in the data. An intuitive way of thinking about this is that we are assuming that participants are all individuals, but they do share some common characteristics, and we can use information obtained from other participants to inform our estimates. This is what _partial pooling_ refers to.</span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>While multilevel models are outside the scope of this course, we will look some basic models in our final session on Baysian data analysis. The basic idea is that each individual participant's parameters are treated as random draws from a group-level distribution, and the average effect is then simply the mean of that distribution.</span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a>:::aside</span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a>Multilevel models do not have to be Bayesian - the can just as well be estimated using maximum likelihood estimation.</span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a><span class="fu">## Frequentist statistics</span></span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a>The traditional approach to statistics is know as frequentist statistics. We will first go through the basic principles, then discuss some of the limitations associated with this approach, and then contrast this with the Bayesian approach. </span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a>In a traditional approach to statistics, students are usually taught a variety of different approaches (far too many to discuss here - there are enough enough different models to fill entire text books). In a nutshell, most of these approachs perform the following steps (I will use an equal-variance independent samples t-test as a running example, as well as the problem of estimating the probability of sucess parameter in a model of Bernoulli trials):</span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a>1) A statistical model is assumed. In the case of the t-test all observations within both groups are assumed to be normally distributed, with the groups differing in the means of the distributions (assuming that the standard deviations of both groups are equal to $\sigma$).</span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb64-96"><a href="#cb64-96" aria-hidden="true" tabindex="-1"></a>y_{ij} \sim \mathcal{N}(\mu_j, \sigma^2)</span>
<span id="cb64-97"><a href="#cb64-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a>$y_{ij}$ refers to the $i_{th}$ observation in group $j \in <span class="sc">\{</span>1, 2<span class="sc">\}</span>$. This observations are assumed to be independent random variates from a normal distribution (i.i.d)^<span class="co">[</span><span class="ot">independent and identically distributed</span><span class="co">]</span>, with the distribution's mean $\mu_j$ depending on the group. In a t-test, we are interested in the difference between the group means, $\mu_2 - \mu_1$.</span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-100"><a href="#cb64-100" aria-hidden="true" tabindex="-1"></a>2) The group means are estimated. This can be done, e.g. using maximum likelihood estimation. You will be more familiar with the technique of "simply" using the sample means to estimate $\mu_j$, which actually corresponds to the maximum likelihood estimate. The third parameter that has to be estimated is $\sigma$. This is the __parameter estimation__ step. $\sigma$ can be estimated using maximum likelihood, or simply "calculated" as the pooled standard deviation $s_p$. In either case, the parameter is estimated.</span>
<span id="cb64-101"><a href="#cb64-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a>3) A test statistic is calculated. In this case, the difference $\mu_1 - \mu_2$ is of interest, and using this difference, a test statistic is computed. The test statistic can be computed as </span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a>t = \frac{\bar{x_1} - \bar{x_2}}{s_p \sqrt{2/n}}</span>
<span id="cb64-106"><a href="#cb64-106" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-107"><a href="#cb64-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a>where $s_p \sqrt{2/n}$ is the standard error of the difference. $t$ is assumed to follow a Student-t distribution (under the null hypothesis), and we can compute the probability of observing a test statistic (estimated from the data) that is at least as extreme (depending on the hypothesis) as the observed one (or rather the t value estimated from the actually observed data), under the assumption that the null hypothesis is true. This tail probability is known as a *p-value*.</span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-111"><a href="#cb64-111" aria-hidden="true" tabindex="-1"></a><span class="fu">### What can we discover with NHST?</span></span>
<span id="cb64-112"><a href="#cb64-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a>It is important to think about what exactly this approach can tell us. For instance, can we discover how probable the null hypothesis is? Can we ask how probable it is that the null hypothesis is false, and that therefore the alternative is true? </span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a>Unfortunately, the answer to both of these questions is **no**, we cannot. </span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a>This approach cannot tell us anything about probabilities of hypotheses - all that we can discover is how likely the data (as summarized by the parameters) are to have occured under the assumption that the null is true. In this case, how likely is the t value, given that there is no difference between the groups, or mathematically, $\mu_1 - \mu_2 = 0$. A small p-value can tell us that the data are unlikely, but that is not really the question we are asking. </span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a>What we would like to know (intuitively) is how likely are our hypotheses <span class="co">[</span><span class="ot">@wagenmakersPracticalSolutionPervasive2007</span><span class="co">]</span>. But this is something that frequentist statistics cannot tell us, by design. In the frequentist interpretation, a probability is the relative frequency of occurence of an event. Under this interpretation, a parameter does not have an associated probability distribution, and the question of how probable certain parameter values are is meaningless. In contrast, in Bayesian statistics, a probability is assumed to represent the degree of belief (either subjective or objective) that a certain parameter value is true. As an example, for a frequentist, talking about the probability that it will rain tomorrow is meaningless, because this is not an experiment that can be repeated infinitely many times. For a Bayesian, on the other hand, the probability of rain is merely an expression of belief, a summary of our state of knowledge.</span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Problems with NHST</span></span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-124"><a href="#cb64-124" aria-hidden="true" tabindex="-1"></a>Even scientists routinely mistake p-values for probabilities of hypotheses. This is actually one of the most common misconceptions, and lead @wassersteinASAStatementPValues2016 to write a *Statement on Statistical</span>
<span id="cb64-125"><a href="#cb64-125" aria-hidden="true" tabindex="-1"></a>Significance and P-Values* in the American Statistical Association. They clarify:</span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>P-values can indicate how incompatible the data are with a specified</span>
<span id="cb64-128"><a href="#cb64-128" aria-hidden="true" tabindex="-1"></a>  statistical model.</span>
<span id="cb64-129"><a href="#cb64-129" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>P-values do not measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone.</span>
<span id="cb64-130"><a href="#cb64-130" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.</span>
<span id="cb64-131"><a href="#cb64-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a>A further complication is that the commonly used threshold $p = 0.05$ is completely arbitrary, and based on a combination of ideas by Fisher and Pearson/Neyman. The modern usage actually reflects neither approaches, and  is often considered to be a bit of a mess <span class="co">[</span><span class="ot">@amrheinScientistsRiseStatistical2019</span><span class="co">]</span>. @gigerenzerMindlessStatistics2004;@gigerenzerStatisticalRitualsReplication2018a provides an interesting comment on modern usage of hypothesis testing.</span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a>Apart from not being particularly intuitive and not allowing us to adress the questions we would like to  answer, NHST also has the problem that incentive structures in scientific publishing can often lead to misapplications of NHST procedures. Various questionable research practices are associated with this, including _p-hacking_. This refers to the practice of performing multiple significance tests, and selecting only those that yield significant results for reporting. In other words - NHST, if used correclty, can be a very useful tool. A big problem is that it os often not used correctly, and this can lead to misleading results.</span>
<span id="cb64-135"><a href="#cb64-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-136"><a href="#cb64-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Case studies</span></span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a>We will briefly explore the frequentist approach to data analysis using two examples:</span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a>1) an independent samples t-test, and</span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a>2) the card game from the previous chapter, and</span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a><span class="fu">### T-test {#sec-fancyhat}</span></span>
<span id="cb64-145"><a href="#cb64-145" aria-hidden="true" tabindex="-1"></a>This example uses simulated data, but is based on an actual study. </span>
<span id="cb64-146"><a href="#cb64-146" aria-hidden="true" tabindex="-1"></a>In the code below, we simulate creativity scores from two groups. One group was instructed to wear a fancy hat, the other, woth no head gear, serves as a control group. We would like to know whether the fancy hat group and the control group differ in their mean creativity.</span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-153"><a href="#cb64-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-154"><a href="#cb64-154" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of people wearing fancy hats</span></span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a>N_fancyhats <span class="ot">&lt;-</span> <span class="dv">50</span> </span>
<span id="cb64-158"><a href="#cb64-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-159"><a href="#cb64-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of people not wearing fancy hats</span></span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a>N_nofancyhats <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Population mean of creativity for people wearing fancy hats</span></span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a>mu_fancyhats <span class="ot">&lt;-</span> <span class="dv">103</span> </span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Population mean of creativity for people wearing no fancy hats</span></span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a>mu_nofancyhats <span class="ot">&lt;-</span> <span class="dv">98</span> </span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Average population standard deviation of both groups</span></span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">15</span> </span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>fancyhats <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">Creativity =</span> <span class="fu">rnorm</span>(N_fancyhats, mu_fancyhats, sigma),</span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a>               <span class="at">Group =</span> <span class="st">"Fancy Hat"</span>)</span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a>nofancyhats <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">Creativity =</span> <span class="fu">rnorm</span>(N_nofancyhats, mu_nofancyhats, sigma),</span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Group =</span> <span class="st">"No Fancy Hat"</span>)</span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-179"><a href="#cb64-179" aria-hidden="true" tabindex="-1"></a>FancyHat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(fancyhats, nofancyhats)  <span class="sc">|&gt;</span></span>
<span id="cb64-180"><a href="#cb64-180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">fct_relevel</span>(<span class="fu">as.factor</span>(Group), <span class="st">"No Fancy Hat"</span>))</span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-182"><a href="#cb64-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-183"><a href="#cb64-183" aria-hidden="true" tabindex="-1"></a>We have created a dataframe called <span class="in">`FancyHat`</span>. </span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a>FancyHat</span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a>We can now pretend that we don't know how the data were generated, and treat them as data from an experiment.</span>
<span id="cb64-191"><a href="#cb64-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-192"><a href="#cb64-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-196"><a href="#cb64-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-197"><a href="#cb64-197" aria-hidden="true" tabindex="-1"></a>FancyHat <span class="sc">|&gt;</span> </span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Creativity, <span class="at">x =</span> Group)) <span class="sc">+</span></span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Box Plot of Creativity Values"</span>) <span class="sc">+</span></span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a>Assuming that both groups are normally distributed with the same variance, we can use the t-test to determine whether the mean of the two groups is different.</span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-208"><a href="#cb64-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-209"><a href="#cb64-209" aria-hidden="true" tabindex="-1"></a>fancyhat_ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Creativity <span class="sc">~</span> Group,</span>
<span id="cb64-210"><a href="#cb64-210" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> FancyHat)</span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-216"><a href="#cb64-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a>fancyhat_ttest_tab <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fancyhat_ttest)</span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-222"><a href="#cb64-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a>fancyhat_ttest_tab <span class="sc">|&gt;</span></span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(estimate, estimate1, estimate2, statistic, p.value, conf.low, conf.high) <span class="sc">|&gt;</span></span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb64-226"><a href="#cb64-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-227"><a href="#cb64-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a>It might not be obvious at first glance what we have done here:</span>
<span id="cb64-229"><a href="#cb64-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-230"><a href="#cb64-230" aria-hidden="true" tabindex="-1"></a>1) We assumed that the data are conditionally normally distributed, given the means, with the same variance.</span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a>y_{ij} \sim \mathcal{N}(\mu_j, \sigma^2)</span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a>2) we estimated three parameters: $\mu_1$, $\mu_2$ ^<span class="co">[</span><span class="ot">`estimate1` und `estimate2`</span><span class="co">]</span>, and $\sigma$.</span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a>3) We computed the difference between groups as $\mu_1 - \mu_2$. This gives us an estimate of the difference between the means ^<span class="co">[</span><span class="ot">`estimate`</span><span class="co">]</span>.</span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a>4) We compute a test statistic (empirical t value)^<span class="co">[</span><span class="ot">`statistic`</span><span class="co">]</span>.</span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a>5) We computed the probability of observing the observed difference divided by the standard error, under the null hypothesis that the means are the same ($\mu_1 = \mu_2$)^<span class="co">[</span><span class="ot">`p.value`</span><span class="co">]</span>. This is a two-sided test, i.e. we have no hypothesis as to which group has the larger mean.</span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a>What does the p-value tell us? Does it tell you what you want to know? Do you know what the confidence interval tells you ^<span class="co">[</span><span class="ot">`conf.low` and `conf.high`</span><span class="co">]</span>? </span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a>The p-value is <span class="in">`r fancyhat_ttest$p.value |&gt; round(2)`</span> This is larger that the conventional threshold $\alpha=0.05$. What does this mean?</span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a><span class="fu">### Card game</span></span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a>Two players are playing a game of cards. You observe that they play 9 games, and that player A wins 6 of those. Now you would like to estimate the probability that player A will win the next game. Another way of putting it that you would to estimate the ability of player A to beat player B at this particular game.</span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a>You know that the probability of success must lie in the range $<span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$. What you might not be aware of is that you are assuming a certain probability model, and the probability of success is a parameter of that model. Let's take a closer look:</span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a>We know that the number of $k$ successes in $n$ games follows a binomial distribution with parameters $n$ and $\theta$. To make things simpler, we also know that each individual game is independent of the others, and the probability of success $\theta$ is the same for each game. Each success therefore follows a Bernoulli distribution with parameter $\theta$.</span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a>y_i \sim \mathcal{Bernoulli}(\theta)</span>
<span id="cb64-264"><a href="#cb64-264" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-265"><a href="#cb64-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a>:::{callout-tip}</span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a>I will generally use the notation $y$ for a variable that is observed, i.e. the data.</span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a>$y_i$ is the $i$ th observation in the data, meaning that it tells us whether player A won the game or not on trial $i$. $\theta$ is the probability of success for each individual game; this is a parameter of our model ($\mathcal{M}$).</span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a>Previously, we used maximum likelihood to estimate $\theta$ - we will repeat this briefly here.</span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-277"><a href="#cb64-277" aria-hidden="true" tabindex="-1"></a>wins <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb64-278"><a href="#cb64-278" aria-hidden="true" tabindex="-1"></a>games <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a>The goal is to figure out the "best" value of $\theta$, i.e. the value that maximizes the likelihood of observing the data. To do this, we need to consider a range of possible values of $\theta$ (we already know that this range is $<span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$, so that part is easy). We will consider 101 values of $\theta$ between 0 and 1, and compute the likelihood of observing the data for each value of $\theta$.</span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a>n_points <span class="ot">&lt;-</span> <span class="dv">101</span></span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a>theta_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="dv">0</span> , <span class="at">to=</span><span class="dv">1</span> , <span class="at">length.out =</span> n_points )</span>
<span id="cb64-288"><a href="#cb64-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-289"><a href="#cb64-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a>Assuming that both players have an equal chance of winning, the parameter should be $\theta = 0.5$. The probability of the data given $\theta = 0.5$ is:</span>
<span id="cb64-291"><a href="#cb64-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> wins, <span class="at">size =</span> games, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb64-296"><a href="#cb64-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-297"><a href="#cb64-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a>The probability of winning 6 out of 9 games, given that both players are equally likely to win, is <span class="in">`r dbinom(x = wins, size = games, prob = 0.5)`</span>.</span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a>We can also compute the probability of A winning 6, 7, 8 or 9 games, using the cumulative distribution function of the binomial distribution.</span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-305"><a href="#cb64-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-306"><a href="#cb64-306" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">5</span>, <span class="at">size =</span> games, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a>or</span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-313"><a href="#cb64-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-314"><a href="#cb64-314" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">5</span>, <span class="at">size =</span> games, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a>:::aside</span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a><span class="in">`pbinom()`</span> gives us the lower tail probability, which is the probability that the number of successes is less than or equal to the given value, by default.</span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-value</span></span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a>Does this seem familiar?</span>
<span id="cb64-326"><a href="#cb64-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-327"><a href="#cb64-327" aria-hidden="true" tabindex="-1"></a>If we want to quantify our _null_ hypothsis that both players are equally likely to win, we would assume that $\theta=0.5$. Computing the probability of the data under the null is exactly what we have just done. We then plug in the actual data, i.e. 6 out of 9, and the upper tail probability is the p-value. In this case, the p-value is approximately $0.25$. Using cut-off of 0.05, we would not reject the null hypothesis, and conclude that there is not enough evidence that player A is better than player B (this is a one-sided test).</span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a>Now we compute the probability of the data under all parameter values under consideration. In R, this is very simple, since all functions are vectorized.</span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-335"><a href="#cb64-335" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(wins , <span class="at">size =</span> games , <span class="at">prob =</span> theta_grid)</span>
<span id="cb64-336"><a href="#cb64-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(likelihood)</span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a>We can see in the above figure that the probability of observing the data is small for a lot of values of $\theta$. The probability of observing the data, or the likelihood, is maximal for the value <span class="in">`r 6/9`</span>:</span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a>theta_grid[<span class="fu">which.max</span>(likelihood)]</span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a>What we have done so far highlights the distinction between parameter estimation and hypothesis testing. Computing the tail probability under the null ($\theta=0.5$) is a hypothesis test, and estimating $\theta$ is parameter estimation.</span>
<span id="cb64-354"><a href="#cb64-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-355"><a href="#cb64-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-356"><a href="#cb64-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-357"><a href="#cb64-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-358"><a href="#cb64-358" aria-hidden="true" tabindex="-1"></a><span class="fu">## An introduction to Bayesian inference</span></span>
<span id="cb64-359"><a href="#cb64-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-360"><a href="#cb64-360" aria-hidden="true" tabindex="-1"></a>So far, we haven't considered any prior knowledge we might have had about which parameters are the most likely a priori. In fact, as we will see a bit further down, we have implicitly assumed that all parameters are equally likely. We will now introduce a new concept: a prior distribution for the parameter(s) we are trying to estimate^<span class="co">[</span><span class="ot">In frequentist statistics, the concept is meaningless - parameters cannot have distribution. In Bayesian statistics, a prior distribution should reflect everything we know about the parameter, before we consider the data. The prior reflects our belief, which can be subjective, or objective.</span><span class="co">]</span>.</span>
<span id="cb64-361"><a href="#cb64-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-362"><a href="#cb64-362" aria-hidden="true" tabindex="-1"></a>We will then use that __prior__ belief in order to obtain a __posterior__ belief</span>
<span id="cb64-363"><a href="#cb64-363" aria-hidden="true" tabindex="-1"></a>over the possible parameter values. To do this, we need to multiply the prior probability of each parameter value by the likelihood of the data, i.e. by the probability of observing the data given that parameter value. This is an application of Bayes theorem:</span>
<span id="cb64-364"><a href="#cb64-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-365"><a href="#cb64-365" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb64-366"><a href="#cb64-366" aria-hidden="true" tabindex="-1"></a>p(\theta|y) = \frac{ p(y|\theta) * p(\theta) } {p(y)}</span>
<span id="cb64-367"><a href="#cb64-367" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-368"><a href="#cb64-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-369"><a href="#cb64-369" aria-hidden="true" tabindex="-1"></a>This states that the posterior probability of $\theta$ given the observed data $y$ is equal to the probability of the data, multiplied by how probable each value of $\theta$ is a priori. You can think of it like this: each parameter value is weighted according to how well it predicts the data. The product $p(y|\theta) * p(\theta)$ is then divided by the probability of the data, which in this case is summed over all possible parameter values. This step serves to normalize the posterior, so that it sums to $1$. This essentially turns the unnormalized posterior into a proper probability distribution.</span>
<span id="cb64-370"><a href="#cb64-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-371"><a href="#cb64-371" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-372"><a href="#cb64-372" aria-hidden="true" tabindex="-1"></a>p(y) = \sum_{\theta}p(y|\theta) * p(\theta) </span>
<span id="cb64-373"><a href="#cb64-373" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-374"><a href="#cb64-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-375"><a href="#cb64-375" aria-hidden="true" tabindex="-1"></a>When we are interested in estimating the parameters of a given model, we can often neglect the (constant for a model) normalizing term $p(y)$. This term, often called the evidence, reflects the probability of the data, averaged over all parameter values. Written without the normalizing constant, Bayes rule is often written as:</span>
<span id="cb64-376"><a href="#cb64-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-377"><a href="#cb64-377" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb64-378"><a href="#cb64-378" aria-hidden="true" tabindex="-1"></a>p(\theta|y) \propto  p(y|\theta) * p(\theta) </span>
<span id="cb64-379"><a href="#cb64-379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-380"><a href="#cb64-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-381"><a href="#cb64-381" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recap </span></span>
<span id="cb64-382"><a href="#cb64-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-383"><a href="#cb64-383" aria-hidden="true" tabindex="-1"></a>Bayesian inference, in a nutshell, consists of:</span>
<span id="cb64-384"><a href="#cb64-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-385"><a href="#cb64-385" aria-hidden="true" tabindex="-1"></a>1) Represent your prior belief by a probability distribution over the possible parameter values. This is a principled way of dealing with uncertainty.</span>
<span id="cb64-386"><a href="#cb64-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-387"><a href="#cb64-387" aria-hidden="true" tabindex="-1"></a>2) Use the likelihood to weight the prior belief.</span>
<span id="cb64-388"><a href="#cb64-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-389"><a href="#cb64-389" aria-hidden="true" tabindex="-1"></a>3) Obtain a posterior belief over the possible parameter values.</span>
<span id="cb64-390"><a href="#cb64-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-391"><a href="#cb64-391" aria-hidden="true" tabindex="-1"></a>:::aside</span>
<span id="cb64-392"><a href="#cb64-392" aria-hidden="true" tabindex="-1"></a>The term _belief_ is used synonymously with _probability distribution_.</span>
<span id="cb64-393"><a href="#cb64-393" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-394"><a href="#cb64-394" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-395"><a href="#cb64-395" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian inference in the card game: a numerical example</span></span>
<span id="cb64-396"><a href="#cb64-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-397"><a href="#cb64-397" aria-hidden="true" tabindex="-1"></a>Recall that we defined a sequence of 101 points between 0 and 1, which represented the possible $\theta$ values.</span>
<span id="cb64-398"><a href="#cb64-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-401"><a href="#cb64-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-402"><a href="#cb64-402" aria-hidden="true" tabindex="-1"></a>n_points <span class="ot">&lt;-</span> <span class="dv">101</span></span>
<span id="cb64-403"><a href="#cb64-403" aria-hidden="true" tabindex="-1"></a>theta_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="at">from=</span><span class="dv">0</span> , <span class="at">to=</span><span class="dv">1</span> , <span class="at">length.out =</span> n_points )</span>
<span id="cb64-404"><a href="#cb64-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-405"><a href="#cb64-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-406"><a href="#cb64-406" aria-hidden="true" tabindex="-1"></a>For each of these, we computed the likelihood, that is the probability of observing the (fixed) data, given the parameter. Now, we can make our knowledge about the probability of each parameter value explicit. At first, we will assume that all parameters are equally likely. We will assign the probability of 1 to each parameter value. This is our prior distribution. </span>
<span id="cb64-407"><a href="#cb64-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-408"><a href="#cb64-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-411"><a href="#cb64-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-412"><a href="#cb64-412" aria-hidden="true" tabindex="-1"></a>prior_1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(theta_grid))</span>
<span id="cb64-413"><a href="#cb64-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-414"><a href="#cb64-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-417"><a href="#cb64-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-418"><a href="#cb64-418" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta_grid, prior_1, <span class="st">"type"</span> <span class="ot">=</span> <span class="st">"l"</span>)</span>
<span id="cb64-419"><a href="#cb64-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-420"><a href="#cb64-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-421"><a href="#cb64-421" aria-hidden="true" tabindex="-1"></a>We could also express the belief that player is at least as good as player B, i.e. they are equally good or A is better than B. One way of doing this is to assign a probability of $1$ to parameter values greater than or equal to $0.5$, and the value $0$ to parameter values less than $0.5$.</span>
<span id="cb64-422"><a href="#cb64-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-425"><a href="#cb64-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-426"><a href="#cb64-426" aria-hidden="true" tabindex="-1"></a>prior_2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(theta_grid <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb64-427"><a href="#cb64-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-428"><a href="#cb64-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-431"><a href="#cb64-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-432"><a href="#cb64-432" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta_grid, prior_2, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb64-433"><a href="#cb64-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-434"><a href="#cb64-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-435"><a href="#cb64-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-436"><a href="#cb64-436" aria-hidden="true" tabindex="-1"></a>A more systematic way of doing this is to use a parameterized probability distribution that expresses our beliefs about the parameter. </span>
<span id="cb64-437"><a href="#cb64-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-438"><a href="#cb64-438" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb64-439"><a href="#cb64-439" aria-hidden="true" tabindex="-1"></a>A family of probability distributions that are suitable for parameters that lie in the interval $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ is the <span class="co">[</span><span class="ot">Beta distribution</span><span class="co">](https://en.wikipedia.org/wiki/Beta_distribution)</span>. This distribution has $2$ parameters $\alpha$ und $\beta$, </span>
<span id="cb64-440"><a href="#cb64-440" aria-hidden="true" tabindex="-1"></a>which can be interpreted as the prior number of successes and the number of failures, respectively. The number of trials is therefore $\alpha + \beta$. @ref(fig:betadist) shows a number of possible Beta distributions for various settings of $\alpha$ and $\beta$.</span>
<span id="cb64-441"><a href="#cb64-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-442"><a href="#cb64-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-445"><a href="#cb64-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-446"><a href="#cb64-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: betadist</span></span>
<span id="cb64-447"><a href="#cb64-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beta distributions"</span></span>
<span id="cb64-448"><a href="#cb64-448" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-449"><a href="#cb64-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-450"><a href="#cb64-450" aria-hidden="true" tabindex="-1"></a>length <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb64-451"><a href="#cb64-451" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">shape1 =</span> <span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb64-452"><a href="#cb64-452" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape2 =</span> <span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb64-453"><a href="#cb64-453" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="fu">nesting</span>(shape1, shape2),</span>
<span id="cb64-454"><a href="#cb64-454" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> length)) <span class="sc">|&gt;</span> </span>
<span id="cb64-455"><a href="#cb64-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a =</span> <span class="fu">str_c</span>(<span class="st">"a = "</span>, shape1),</span>
<span id="cb64-456"><a href="#cb64-456" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> <span class="fu">str_c</span>(<span class="st">"b = "</span>, shape2),</span>
<span id="cb64-457"><a href="#cb64-457" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>length, <span class="at">each =</span> <span class="dv">25</span>))</span>
<span id="cb64-458"><a href="#cb64-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-459"><a href="#cb64-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-462"><a href="#cb64-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-463"><a href="#cb64-463" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb64-464"><a href="#cb64-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb64-465"><a href="#cb64-465" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-466"><a href="#cb64-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="at">shape1 =</span> shape1, <span class="at">shape2 =</span> shape2)),</span>
<span id="cb64-467"><a href="#cb64-467" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"steelblue4"</span>, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb64-468"><a href="#cb64-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(theta), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-469"><a href="#cb64-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb64-470"><a href="#cb64-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Beta distributions"</span>,</span>
<span id="cb64-471"><a href="#cb64-471" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">p</span>(theta<span class="sc">*</span><span class="st">"|"</span><span class="sc">*</span>a<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>b))) <span class="sc">+</span></span>
<span id="cb64-472"><a href="#cb64-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb64-473"><a href="#cb64-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(b<span class="sc">~</span>a)</span>
<span id="cb64-474"><a href="#cb64-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-475"><a href="#cb64-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-476"><a href="#cb64-476" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-477"><a href="#cb64-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-478"><a href="#cb64-478" aria-hidden="true" tabindex="-1"></a>If we want to use a Beta distribution to express the belief that all values of $\theta$ are equally likely (uniform prior), we can a Beta distribution with $\alpha = 1$ and $\beta = 1$.</span>
<span id="cb64-479"><a href="#cb64-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-482"><a href="#cb64-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-483"><a href="#cb64-483" aria-hidden="true" tabindex="-1"></a>prior_3 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>)</span>
<span id="cb64-484"><a href="#cb64-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-485"><a href="#cb64-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-488"><a href="#cb64-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-489"><a href="#cb64-489" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta_grid, prior_3, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb64-490"><a href="#cb64-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-491"><a href="#cb64-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-492"><a href="#cb64-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-493"><a href="#cb64-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-494"><a href="#cb64-494" aria-hidden="true" tabindex="-1"></a>Finally, we could express the following prior information as a Beta distribution: imagine you had previously observed $100$ games between A and B, and each won half of the games. You can set $\alpha$ and $\beta$ to the number of games won by A, and the number of games won by B, respectively.  A won $50$, and B won $50$:</span>
<span id="cb64-495"><a href="#cb64-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-498"><a href="#cb64-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-499"><a href="#cb64-499" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">50</span>, <span class="at">shape2 =</span> <span class="dv">50</span>)</span>
<span id="cb64-500"><a href="#cb64-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-501"><a href="#cb64-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-504"><a href="#cb64-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-505"><a href="#cb64-505" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta_grid, prior, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb64-506"><a href="#cb64-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-507"><a href="#cb64-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-508"><a href="#cb64-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-509"><a href="#cb64-509" aria-hidden="true" tabindex="-1"></a>Now, we can combine the prior and the likelihood by multiplying them element-wise, i.e. we need to multiply each parameter value with the probability of the data given that parameter. </span>
<span id="cb64-510"><a href="#cb64-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-511"><a href="#cb64-511" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb64-512"><a href="#cb64-512" aria-hidden="true" tabindex="-1"></a>Recall Bayes theorem:</span>
<span id="cb64-513"><a href="#cb64-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-514"><a href="#cb64-514" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-515"><a href="#cb64-515" aria-hidden="true" tabindex="-1"></a>p(\theta|y) = \frac{ p(y|\theta) * p(\theta) } {p(y)}</span>
<span id="cb64-516"><a href="#cb64-516" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-517"><a href="#cb64-517" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-518"><a href="#cb64-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-519"><a href="#cb64-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-520"><a href="#cb64-520" aria-hidden="true" tabindex="-1"></a>In R, this is simply:</span>
<span id="cb64-521"><a href="#cb64-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-522"><a href="#cb64-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-525"><a href="#cb64-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-526"><a href="#cb64-526" aria-hidden="true" tabindex="-1"></a>wins <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb64-527"><a href="#cb64-527" aria-hidden="true" tabindex="-1"></a>games <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb64-528"><a href="#cb64-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-529"><a href="#cb64-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-532"><a href="#cb64-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-533"><a href="#cb64-533" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">4</span>)</span>
<span id="cb64-534"><a href="#cb64-534" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(wins , <span class="at">size =</span> games , <span class="at">prob =</span> theta_grid)</span>
<span id="cb64-535"><a href="#cb64-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-536"><a href="#cb64-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-537"><a href="#cb64-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-540"><a href="#cb64-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-541"><a href="#cb64-541" aria-hidden="true" tabindex="-1"></a>unstandardized_posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb64-542"><a href="#cb64-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-543"><a href="#cb64-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-544"><a href="#cb64-544" aria-hidden="true" tabindex="-1"></a>This gives us the unnormalized posterior:</span>
<span id="cb64-545"><a href="#cb64-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-546"><a href="#cb64-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-547"><a href="#cb64-547" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb64-548"><a href="#cb64-548" aria-hidden="true" tabindex="-1"></a>p(\theta|y) \propto  p(y|\theta) * p(\theta)</span>
<span id="cb64-549"><a href="#cb64-549" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-550"><a href="#cb64-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-551"><a href="#cb64-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-552"><a href="#cb64-552" aria-hidden="true" tabindex="-1"></a>We can then normalize the posterior distribution by dividing it by $p(y) = \sum_{\theta}p(y|\theta) * p(\theta)$. </span>
<span id="cb64-553"><a href="#cb64-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-554"><a href="#cb64-554" aria-hidden="true" tabindex="-1"></a>In R we can use the <span class="in">`sum()`</span> function: <span class="in">`sum(unstandardized_posterior)`</span>.</span>
<span id="cb64-555"><a href="#cb64-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-556"><a href="#cb64-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-559"><a href="#cb64-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-560"><a href="#cb64-560" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> unstandardized_posterior <span class="sc">/</span> <span class="fu">sum</span>(unstandardized_posterior)</span>
<span id="cb64-561"><a href="#cb64-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-562"><a href="#cb64-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-563"><a href="#cb64-563" aria-hidden="true" tabindex="-1"></a>We can now plot the resulting normalized posterior distribution. </span>
<span id="cb64-564"><a href="#cb64-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-567"><a href="#cb64-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-568"><a href="#cb64-568" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta_grid, posterior, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">'Probability'</span>, </span>
<span id="cb64-569"><a href="#cb64-569" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Posterior"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">cex.main =</span> <span class="dv">3</span>)</span>
<span id="cb64-570"><a href="#cb64-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-571"><a href="#cb64-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-572"><a href="#cb64-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-573"><a href="#cb64-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-574"><a href="#cb64-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-575"><a href="#cb64-575" aria-hidden="true" tabindex="-1"></a>To make this repeatable, we will write two functions. The first, <span class="in">`compute_posterior()`</span>, will compute the posterior, given the prior and likelihood, and return a dataframe containing prior, likelihood and posterior. The second, <span class="in">`plot_posterior()`</span>, will plot all three side-by-side. You can also pass in the maximum likelihood estimate, e.g. <span class="in">`6/9`</span>, and this will be plotted as well.</span>
<span id="cb64-576"><a href="#cb64-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-579"><a href="#cb64-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-580"><a href="#cb64-580" aria-hidden="true" tabindex="-1"></a>compute_posterior <span class="ot">=</span> <span class="cf">function</span>(likelihood, prior){</span>
<span id="cb64-581"><a href="#cb64-581" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute product of likelihood and prior</span></span>
<span id="cb64-582"><a href="#cb64-582" aria-hidden="true" tabindex="-1"></a>  unstandardized_posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb64-583"><a href="#cb64-583" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-584"><a href="#cb64-584" aria-hidden="true" tabindex="-1"></a>  <span class="co"># standardize the posterior, so it sums to 1</span></span>
<span id="cb64-585"><a href="#cb64-585" aria-hidden="true" tabindex="-1"></a>  posterior <span class="ot">&lt;-</span> unstandardized_posterior <span class="sc">/</span> <span class="fu">sum</span>(unstandardized_posterior)</span>
<span id="cb64-586"><a href="#cb64-586" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-587"><a href="#cb64-587" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">tibble</span>(prior, likelihood, posterior)</span>
<span id="cb64-588"><a href="#cb64-588" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb64-589"><a href="#cb64-589" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-590"><a href="#cb64-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-591"><a href="#cb64-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-594"><a href="#cb64-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-595"><a href="#cb64-595" aria-hidden="true" tabindex="-1"></a>plot_posterior <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">mle =</span> <span class="dv">6</span><span class="sc">/</span><span class="dv">9</span>){</span>
<span id="cb64-596"><a href="#cb64-596" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, {</span>
<span id="cb64-597"><a href="#cb64-597" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb64-598"><a href="#cb64-598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(theta_grid , prior, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">main=</span><span class="st">"Prior"</span>, <span class="at">col =</span> <span class="st">"dodgerblue3"</span>, </span>
<span id="cb64-599"><a href="#cb64-599" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">'Probability'</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">cex.main =</span> <span class="dv">3</span>)</span>
<span id="cb64-600"><a href="#cb64-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(theta_grid , likelihood, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Likelihood"</span>, <span class="at">col =</span> <span class="st">"firebrick3"</span>, </span>
<span id="cb64-601"><a href="#cb64-601" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">cex.main =</span> <span class="dv">3</span>)</span>
<span id="cb64-602"><a href="#cb64-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(theta_grid , posterior , <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Posterior"</span>, <span class="at">col =</span> <span class="st">"darkorchid3"</span>, </span>
<span id="cb64-603"><a href="#cb64-603" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">cex.main =</span> <span class="dv">3</span>)</span>
<span id="cb64-604"><a href="#cb64-604" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> mle, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb64-605"><a href="#cb64-605" aria-hidden="true" tabindex="-1"></a>  } )</span>
<span id="cb64-606"><a href="#cb64-606" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-607"><a href="#cb64-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-608"><a href="#cb64-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-609"><a href="#cb64-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-610"><a href="#cb64-610" aria-hidden="true" tabindex="-1"></a>You can now try out various prior distributions, and observe the effect on the posterior.</span>
<span id="cb64-611"><a href="#cb64-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-612"><a href="#cb64-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-613"><a href="#cb64-613" aria-hidden="true" tabindex="-1"></a>Let's try out a uniform prior first:</span>
<span id="cb64-614"><a href="#cb64-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-617"><a href="#cb64-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-618"><a href="#cb64-618" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>)</span>
<span id="cb64-619"><a href="#cb64-619" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(wins , <span class="at">size =</span> games , <span class="at">prob =</span> theta_grid)</span>
<span id="cb64-620"><a href="#cb64-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-621"><a href="#cb64-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-622"><a href="#cb64-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-623"><a href="#cb64-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-626"><a href="#cb64-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-627"><a href="#cb64-627" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">compute_posterior</span>(likelihood, prior)</span>
<span id="cb64-628"><a href="#cb64-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-629"><a href="#cb64-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-630"><a href="#cb64-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-633"><a href="#cb64-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-634"><a href="#cb64-634" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_posterior</span>(df)</span>
<span id="cb64-635"><a href="#cb64-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-636"><a href="#cb64-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-637"><a href="#cb64-637" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb64-638"><a href="#cb64-638" aria-hidden="true" tabindex="-1"></a>In this case, the maximum likelihood estimate coincides with the value that maximizes the posterior probability. This is the case because maximum likelihood estimate uses only the likelihood and does not consider prior knowledge. If we are are using a uniform prior, that amounts to saying that all values of $\theta$ are equally likely. In other words, we have no information as which values are more probable.</span>
<span id="cb64-639"><a href="#cb64-639" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-640"><a href="#cb64-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-641"><a href="#cb64-641" aria-hidden="true" tabindex="-1"></a>Now let's try out our prior expressing the belief that player A cannot be worse than player B:</span>
<span id="cb64-642"><a href="#cb64-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-645"><a href="#cb64-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-646"><a href="#cb64-646" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(theta_grid <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb64-647"><a href="#cb64-647" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(wins , <span class="at">size =</span> games , <span class="at">prob =</span> theta_grid)</span>
<span id="cb64-648"><a href="#cb64-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-649"><a href="#cb64-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-650"><a href="#cb64-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-651"><a href="#cb64-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-654"><a href="#cb64-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-655"><a href="#cb64-655" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">compute_posterior</span>(likelihood, prior)</span>
<span id="cb64-656"><a href="#cb64-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-657"><a href="#cb64-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-660"><a href="#cb64-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-661"><a href="#cb64-661" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_posterior</span>(df)</span>
<span id="cb64-662"><a href="#cb64-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-663"><a href="#cb64-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-664"><a href="#cb64-664" aria-hidden="true" tabindex="-1"></a>The resulting posterior distribution is zero for all values of $\theta$ that are less than 0.5. This is because our prior allocates zero probability those values.</span>
<span id="cb64-665"><a href="#cb64-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-666"><a href="#cb64-666" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb64-667"><a href="#cb64-667" aria-hidden="true" tabindex="-1"></a>Try out various priors. How do they affect the posterior?</span>
<span id="cb64-668"><a href="#cb64-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-669"><a href="#cb64-669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A prior expressing the belief that B is better than A.</span>
<span id="cb64-670"><a href="#cb64-670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A prior expressing that belief that either A is a lot better, or B is a lot better.</span>
<span id="cb64-671"><a href="#cb64-671" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A prior expressing the belief that the players are probably as good as each other, and that it is unlikely that either is much better than the other.</span>
<span id="cb64-672"><a href="#cb64-672" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-673"><a href="#cb64-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-674"><a href="#cb64-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-675"><a href="#cb64-675" aria-hidden="true" tabindex="-1"></a>The posterior represents our belief about the the possible parameter values, after having observed the data. You can therefore think of Bayesian inference as a method for updating your beliefs, conditional on observed data. You are re-allocating probabilities over parameter values, depending on how well those parameter values predicted the data.</span>
<span id="cb64-676"><a href="#cb64-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-677"><a href="#cb64-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-678"><a href="#cb64-678" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analytic solution for the Bernoulli/Binomial likelihood and Beta prior</span></span>
<span id="cb64-679"><a href="#cb64-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-680"><a href="#cb64-680" aria-hidden="true" tabindex="-1"></a>In the above example, we used a technique called grid approximation to obtain the posterior distribution for a parameter. This means that we tried out various parameter values by constructing a grid, and then computed the posterior by applying Bayes' rule. This technique was used merely for educational purposes, as it does not scale well to real-world problems. In the simple example of a sequence of binary observations, the parameter of interest (the probability of success $\theta$ in a Bernoulli trial) is bounded between $0$ and $1$ ($\theta \in <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$). Furthermore, there is only $1$ parameter to estimate. In more complex models, with many parameters, using grid approximation can be very inefficient, or even impossible. In such cases, we usually use numerical methods to approximate the posterior distribution. These methods are know collectively as *Monte Carlo sampling*, or *Markov Chain Monte Carlo* (MCMC). Using MCMC, we will not obtain an analytical description of posterior distributions, but instead a collection of random numbers (samples), that are drawn from the posterior distribution. We will use these samples to represent the posterior distribution.</span>
<span id="cb64-681"><a href="#cb64-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-682"><a href="#cb64-682" aria-hidden="true" tabindex="-1"></a>In this particular case, however, we also obtain the posterior distribution $p(\theta|y)$ analytically. By this, I mean that if we use a Beta distribution to describe our prior belief over the $\theta$ parameter, and the likelihood is Bernoulli or Binomial, the posterior distribution is also a Beta distribution.</span>
<span id="cb64-683"><a href="#cb64-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-684"><a href="#cb64-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-685"><a href="#cb64-685" aria-hidden="true" tabindex="-1"></a>This is shown here for the Binomial likelihood:</span>
<span id="cb64-686"><a href="#cb64-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-687"><a href="#cb64-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-688"><a href="#cb64-688" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-689"><a href="#cb64-689" aria-hidden="true" tabindex="-1"></a>p(\theta|z, N) = \frac{p(y|\theta) \cdot p(\theta) = \theta^z (1-\theta)^{N-z} \cdot beta(\theta|a, b)}{p(z, N)}</span>
<span id="cb64-690"><a href="#cb64-690" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-691"><a href="#cb64-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-692"><a href="#cb64-692" aria-hidden="true" tabindex="-1"></a>where $z$ is the number of successes, $N$ is the number of trials, and $a, b$ are the parameters of the Beta distribution.</span>
<span id="cb64-693"><a href="#cb64-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-694"><a href="#cb64-694" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-695"><a href="#cb64-695" aria-hidden="true" tabindex="-1"></a>p(\theta|a, b) = beta(\theta|a, b) = \frac{\theta^{a-1} (1-\theta)^{b-1}} {B(a, b)}</span>
<span id="cb64-696"><a href="#cb64-696" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-697"><a href="#cb64-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-698"><a href="#cb64-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-699"><a href="#cb64-699" aria-hidden="true" tabindex="-1"></a>The function $B(a, b)$ is a normalizing constant and ensures that the area under the curve integrates to $1$.</span>
<span id="cb64-700"><a href="#cb64-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-701"><a href="#cb64-701" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-702"><a href="#cb64-702" aria-hidden="true" tabindex="-1"></a>p(\theta|z, N) = \frac{\theta^{(a+z)-1} (1-\theta)^{(b+N-z)-1}} { B(a+z, b+N-z) }</span>
<span id="cb64-703"><a href="#cb64-703" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-704"><a href="#cb64-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-705"><a href="#cb64-705" aria-hidden="true" tabindex="-1"></a>Put more simply: </span>
<span id="cb64-706"><a href="#cb64-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-707"><a href="#cb64-707" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb64-708"><a href="#cb64-708" aria-hidden="true" tabindex="-1"></a>If the prior distribution is $beta(\theta|a, b)$, and the data have $z$ heads in $N$ flips, then the posterior distribution is $beta(\theta|a + z, b + N ‚àí z)$.</span>
<span id="cb64-709"><a href="#cb64-709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-710"><a href="#cb64-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-711"><a href="#cb64-711" aria-hidden="true" tabindex="-1"></a>You can therefore think of the parameters $a$ and $b$ as the prior successes and failures in $N$ trials, and these parameters are updated by observing $z$ heads in $N$ flips.</span>
<span id="cb64-712"><a href="#cb64-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-713"><a href="#cb64-713" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example</span></span>
<span id="cb64-714"><a href="#cb64-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-715"><a href="#cb64-715" aria-hidden="true" tabindex="-1"></a>This time, we are using <span class="in">`theta_grid`</span> merely so we can plot the prior and posterior. Suppose that we have observed 8 games, and that player A has won 4 of those. Our prior should therefore be $p(\theta|4,4)$</span>
<span id="cb64-716"><a href="#cb64-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-719"><a href="#cb64-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-720"><a href="#cb64-720" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">4</span>)</span>
<span id="cb64-721"><a href="#cb64-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-722"><a href="#cb64-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-723"><a href="#cb64-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-726"><a href="#cb64-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-727"><a href="#cb64-727" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(theta_grid, prior, <span class="st">"l"</span>)</span>
<span id="cb64-728"><a href="#cb64-728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-729"><a href="#cb64-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-730"><a href="#cb64-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-731"><a href="#cb64-731" aria-hidden="true" tabindex="-1"></a>If we now observe that player A wins 3 out of the next 4 games, our posterior should be $p(\theta|4+3,4+1)$</span>
<span id="cb64-732"><a href="#cb64-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-733"><a href="#cb64-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-734"><a href="#cb64-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-737"><a href="#cb64-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-738"><a href="#cb64-738" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">7</span>, <span class="at">shape2 =</span> <span class="dv">5</span>)</span>
<span id="cb64-739"><a href="#cb64-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-740"><a href="#cb64-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-741"><a href="#cb64-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-744"><a href="#cb64-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-745"><a href="#cb64-745" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">prior =</span> prior, </span>
<span id="cb64-746"><a href="#cb64-746" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior =</span> posterior, </span>
<span id="cb64-747"><a href="#cb64-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">theta =</span> theta_grid) <span class="sc">|&gt;</span> </span>
<span id="cb64-748"><a href="#cb64-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(prior, posterior), <span class="at">names_to =</span> <span class="st">"distribution"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-749"><a href="#cb64-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(theta, value, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb64-750"><a href="#cb64-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb64-751"><a href="#cb64-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb64-752"><a href="#cb64-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb64-753"><a href="#cb64-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-754"><a href="#cb64-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-755"><a href="#cb64-755" aria-hidden="true" tabindex="-1"></a>We can write a function that updates a Beta prior, given $k$ successes in $N$ trials:</span>
<span id="cb64-756"><a href="#cb64-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-759"><a href="#cb64-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-760"><a href="#cb64-760" aria-hidden="true" tabindex="-1"></a>update_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, k, N) {</span>
<span id="cb64-761"><a href="#cb64-761" aria-hidden="true" tabindex="-1"></a>  theta_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb64-762"><a href="#cb64-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> a <span class="sc">+</span> k, <span class="at">shape2 =</span> b <span class="sc">+</span> N<span class="sc">-</span>k)</span>
<span id="cb64-763"><a href="#cb64-763" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-764"><a href="#cb64-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-765"><a href="#cb64-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-766"><a href="#cb64-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-769"><a href="#cb64-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-770"><a href="#cb64-770" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">update_beta</span>(<span class="at">a =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">N =</span> <span class="dv">4</span>)</span>
<span id="cb64-771"><a href="#cb64-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-772"><a href="#cb64-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-773"><a href="#cb64-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-776"><a href="#cb64-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-777"><a href="#cb64-777" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">prior =</span> prior, </span>
<span id="cb64-778"><a href="#cb64-778" aria-hidden="true" tabindex="-1"></a>       <span class="at">posterior =</span> posterior, </span>
<span id="cb64-779"><a href="#cb64-779" aria-hidden="true" tabindex="-1"></a>       <span class="at">theta =</span> theta_grid) <span class="sc">|&gt;</span> </span>
<span id="cb64-780"><a href="#cb64-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(prior, posterior), <span class="at">names_to =</span> <span class="st">"distribution"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-781"><a href="#cb64-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(theta, value, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb64-782"><a href="#cb64-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb64-783"><a href="#cb64-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb64-784"><a href="#cb64-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb64-785"><a href="#cb64-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-786"><a href="#cb64-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-787"><a href="#cb64-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-788"><a href="#cb64-788" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summarizing the posterior</span></span>
<span id="cb64-789"><a href="#cb64-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-790"><a href="#cb64-790" aria-hidden="true" tabindex="-1"></a>We now need one last step: we need to summarize the posterior distribution. We can do this, for example by computing the mean and standard deviation of the posterior distribution. </span>
<span id="cb64-791"><a href="#cb64-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-792"><a href="#cb64-792" aria-hidden="true" tabindex="-1"></a>To show how this works, we can draw a thousand samples from the posterior distribution. First, we'll create a posterior.</span>
<span id="cb64-793"><a href="#cb64-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-796"><a href="#cb64-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-797"><a href="#cb64-797" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="at">x =</span> theta_grid, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>)</span>
<span id="cb64-798"><a href="#cb64-798" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(wins, <span class="at">size =</span> games , <span class="at">prob =</span> theta_grid)</span>
<span id="cb64-799"><a href="#cb64-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-800"><a href="#cb64-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-801"><a href="#cb64-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-804"><a href="#cb64-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-805"><a href="#cb64-805" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">compute_posterior</span>(likelihood, prior)</span>
<span id="cb64-806"><a href="#cb64-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-807"><a href="#cb64-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-810"><a href="#cb64-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-811"><a href="#cb64-811" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_posterior</span>(df)</span>
<span id="cb64-812"><a href="#cb64-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-813"><a href="#cb64-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-814"><a href="#cb64-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-815"><a href="#cb64-815" aria-hidden="true" tabindex="-1"></a>Now we'll draw 1000 random numbers from the posterior.</span>
<span id="cb64-816"><a href="#cb64-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-819"><a href="#cb64-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-820"><a href="#cb64-820" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb64-821"><a href="#cb64-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-822"><a href="#cb64-822" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> theta_grid <span class="sc">|&gt;</span> <span class="fu">sample</span>(<span class="at">size =</span> n_samples, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> df<span class="sc">$</span>posterior)</span>
<span id="cb64-823"><a href="#cb64-823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-824"><a href="#cb64-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-827"><a href="#cb64-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-828"><a href="#cb64-828" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(samples, <span class="dv">10</span>)</span>
<span id="cb64-829"><a href="#cb64-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-830"><a href="#cb64-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-831"><a href="#cb64-831" aria-hidden="true" tabindex="-1"></a>Now we can summarize the samples, e.g. by computing the mean or quantiles.</span>
<span id="cb64-832"><a href="#cb64-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-835"><a href="#cb64-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-836"><a href="#cb64-836" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples)</span>
<span id="cb64-837"><a href="#cb64-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-838"><a href="#cb64-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-839"><a href="#cb64-839" aria-hidden="true" tabindex="-1"></a>The following will give us the median, and a 50% **credible interval**, i.e. an interval that contains 50% of the mass of the distribution.</span>
<span id="cb64-840"><a href="#cb64-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-841"><a href="#cb64-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-844"><a href="#cb64-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-845"><a href="#cb64-845" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))</span>
<span id="cb64-846"><a href="#cb64-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-847"><a href="#cb64-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-848"><a href="#cb64-848" aria-hidden="true" tabindex="-1"></a>We can also use this approach to compute a 95% credible interval.</span>
<span id="cb64-849"><a href="#cb64-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-852"><a href="#cb64-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-853"><a href="#cb64-853" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb64-854"><a href="#cb64-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-855"><a href="#cb64-855" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb64-856"><a href="#cb64-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-857"><a href="#cb64-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-858"><a href="#cb64-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-859"><a href="#cb64-859" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb64-860"><a href="#cb64-860" aria-hidden="true" tabindex="-1"></a>This should not be confused with the 95% confidence interval. Can you remember how a confidence interval is defined? What is the difference between a confidence interval and a credible interval?</span>
<span id="cb64-861"><a href="#cb64-861" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb64-862"><a href="#cb64-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-863"><a href="#cb64-863" aria-hidden="true" tabindex="-1"></a>What we have done so far is to look at Bayesian inference for parameter estimation (in a very simple model). Let's call this model $\mathcal{M}$. We have only considered one model at a time, but in the next session we will consider two or models $\mathcal{M_j}, which differ in the prior distributions they use. We will then look at methods for comparing models, in order to perform hypothesis testing in a Bayesian framework.</span>
<span id="cb64-864"><a href="#cb64-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-865"><a href="#cb64-865" aria-hidden="true" tabindex="-1"></a>In particular, we will look at how Bayesian model comparison can help, in the case that we have no significant results (see @sec-fancyhat).</span>
<span id="cb64-866"><a href="#cb64-866" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">¬© Copyright 2022, Andrew Ellis</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kogpsy/neuroscicomplabFS22">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>