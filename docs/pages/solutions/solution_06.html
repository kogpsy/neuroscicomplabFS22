<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.301">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Andrew Ellis">
<meta name="dcterms.date" content="2022-05-10">
<meta name="description" content="DDM Parameter schätzen.">
<title>Neurowissenschaft Computerlab - Übung 6: Lösung</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<script src="../../site_libs/quarto-nav/quarto-nav.js"></script><script src="../../site_libs/quarto-nav/headroom.min.js"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script><script src="../../site_libs/quarto-search/fuse.min.js"></script><script src="../../site_libs/quarto-search/quarto-search.js"></script><link href="../..//assets/logo_landing.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script><script src="../../site_libs/quarto-html/popper.min.js"></script><script src="../../site_libs/quarto-html/tippy.umd.min.js"></script><script src="../../site_libs/quarto-html/anchor.min.js"></script><link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link class="quarto-color-scheme" id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script><link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link class="quarto-color-scheme" href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="../../site_libs/bootstrap/bootstrap-dark.min.css">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="../../styles/global.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <img src="../../assets/logo.png" alt=""><span class="navbar-title">Neurowissenschaft Computerlab</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-admin" role="button" data-bs-toggle="dropdown" aria-expanded="false">Admin</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-admin">
<li>
    <a class="dropdown-item" href="../../pages/admin/01_overview.html">
 <span class="dropdown-text">Übersicht</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/admin/02_assessments.html">
 <span class="dropdown-text">Leistungskontrollen</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/admin/03_zulip_forum.html">
 <span class="dropdown-text">Zulip Forum</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-kapitel" role="button" data-bs-toggle="dropdown" aria-expanded="false">Kapitel</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-kapitel">
<li>
    <a class="dropdown-item" href="../../pages/chapters/01_psychopy_experiments.html">
 <span class="dropdown-text">Verhaltensexperiment mit PsychoPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/02_importing_data.html">
 <span class="dropdown-text">Daten importieren</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/03_data_cleaning.html">
 <span class="dropdown-text">Data cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/04_summarizing_data.html">
 <span class="dropdown-text">Daten bearbeiten und zusammenfassen</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/05_signal_detection_i.html">
 <span class="dropdown-text">Signal Detection Theory: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/06_signal_detection_ii.html">
 <span class="dropdown-text">Signal Detection Theory: II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/07_response_times_i.html">
 <span class="dropdown-text">Reaktionszeiten: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/08_response_times_ii.html">
 <span class="dropdown-text">Reaktionszeiten: II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/09_evidence_accumulation_1.html">
 <span class="dropdown-text">Evidence Accumulation Models: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/10_evidence_accumulation_2.html">
 <span class="dropdown-text">Evidence Accumulation Models: II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/11_data-analysis-1.html">
 <span class="dropdown-text">Data analysis: I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/chapters/12_data-analysis-2.html">
 <span class="dropdown-text">Data analysis: II</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false">Slides</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-slides">
<li>
    <a class="dropdown-item" href="../../slides/01_introduction.html">
 <span class="dropdown-text">1. Sitzung (22.02.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/02_psychopy.html">
 <span class="dropdown-text">2. Sitzung (01.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/03_import_and_process_data.html">
 <span class="dropdown-text">3. Sitzung (08.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/04_process_data.html">
 <span class="dropdown-text">4. Sitzung (15.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/05_signal_detection.html">
 <span class="dropdown-text">5. Sitzung (22.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/06_signal_detection_examples.html">
 <span class="dropdown-text">6. Sitzung (29.03.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/07_response_times.html">
 <span class="dropdown-text">7. Sitzung (05.04.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/08_response_times_ii.html">
 <span class="dropdown-text">8. Sitzung (12.04.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/09_evidence_accumulation.html">
 <span class="dropdown-text">9. Sitzung (26.04.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/10_fitting_ddm.html">
 <span class="dropdown-text">10. Sitzung (03.05.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/11_data-analysis-1.html">
 <span class="dropdown-text">11. Sitzung (17.05.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/12_data-analysis-2.html">
 <span class="dropdown-text">12. Sitzung (24.05.2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../slides/13_jasp.html">
 <span class="dropdown-text">13. Sitzung (31.05.2022)</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bungen" role="button" data-bs-toggle="dropdown" aria-expanded="false">Übungen</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bungen">
<li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_01.html">
 <span class="dropdown-text">Übung 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_02.html">
 <span class="dropdown-text">Übung 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_03.html">
 <span class="dropdown-text">Übung 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_04.html">
 <span class="dropdown-text">Übung 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_05.html">
 <span class="dropdown-text">Übung 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_06.html">
 <span class="dropdown-text">Übung 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/exercises/exercise_07.html">
 <span class="dropdown-text">Übung 7</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lösungen" role="button" data-bs-toggle="dropdown" aria-expanded="false">Lösungen</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-lösungen">
<li>
    <a class="dropdown-item" href="../../pages/solutions/solution_03.html">
 <span class="dropdown-text">Übung 3: Lösung</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/solutions/solution_04.html">
 <span class="dropdown-text">Übung 4: Lösung</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/solutions/solution_05.html">
 <span class="dropdown-text">Übung 5: Lösung</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../pages/solutions/solution_06.html">
 <span class="dropdown-text">Übung 6: Lösung</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#aufgabenstellung" id="toc-aufgabenstellung" class="nav-link active" data-scroll-target="#aufgabenstellung">Aufgabenstellung</a>
  <ul class="collapse">
<li><a href="#daten-einlesen" id="toc-daten-einlesen" class="nav-link" data-scroll-target="#daten-einlesen">Daten einlesen</a></li>
  <li><a href="#aufgaben" id="toc-aufgaben" class="nav-link" data-scroll-target="#aufgaben">Aufgaben</a></li>
  <li><a href="#daten-vorbereiten" id="toc-daten-vorbereiten" class="nav-link" data-scroll-target="#daten-vorbereiten">Daten vorbereiten</a></li>
  <li><a href="#daten-zusammenfassen" id="toc-daten-zusammenfassen" class="nav-link" data-scroll-target="#daten-zusammenfassen">Daten zusammenfassen</a></li>
  <li><a href="#negative-loglikelihood-funktion-definieren" id="toc-negative-loglikelihood-funktion-definieren" class="nav-link" data-scroll-target="#negative-loglikelihood-funktion-definieren">Negative loglikelihood Funktion definieren</a></li>
  <li><a href="#startwerte-f%C3%BCr-maxmimum-likelihood-sch%C3%A4tzung" id="toc-startwerte-für-maxmimum-likelihood-schätzung" class="nav-link" data-scroll-target="#startwerte-f%C3%BCr-maxmimum-likelihood-sch%C3%A4tzung">Startwerte für Maxmimum Likelihood Schätzung</a></li>
  <li><a href="#maxmimum-likelihood-sch%C3%A4tzung" id="toc-maxmimum-likelihood-schätzung" class="nav-link" data-scroll-target="#maxmimum-likelihood-sch%C3%A4tzung">Maxmimum Likelihood Schätzung</a></li>
  <li><a href="#gesch%C3%A4tzte-parameterwerte" id="toc-geschätzte-parameterwerte" class="nav-link" data-scroll-target="#gesch%C3%A4tzte-parameterwerte">Geschätzte Parameterwerte</a></li>
  <li><a href="#vergleich-mit-wahren-werten" id="toc-vergleich-mit-wahren-werten" class="nav-link" data-scroll-target="#vergleich-mit-wahren-werten">Vergleich mit wahren Werten</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Übung 6: Lösung</h1>
</div>

<div>
  <div class="description">
    <p>DDM Parameter schätzen.</p>
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">Andrew Ellis <a href="https://orcid.org/0000-0002-2788-936X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>

    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.kog.psy.unibe.ch">
            Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universität Bern
            </a>
          </p>
      </div>
    </div>



<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2022-05-10</p>
    </div>
  </div>
    
  </div>
  

</header><section id="aufgabenstellung" class="level1"><h1>Aufgabenstellung</h1>
<p>In dieser Aufgabe geht es darum, dass Sie einmal selber die Parameter eines DDM an Daten fitten können. Es geht nicht darum, jede Zeile Code zu verstehen; es geht vor allem darum, zu erleben, wie schwierig es sein kann, solche Modelle an Daten zu fitten.</p>
<p>Bitte führen Sie den Code, in dem die Parameter geschätzt werden, mehrmals aus, und kopieren Sie die geschätzten Parameter in ein File. Dies muss abgegeben werden.</p>
<section id="daten-einlesen" class="level2"><h2 class="anchored" data-anchor-id="daten-einlesen">Daten einlesen</h2>
<p>Downloaden Sie die Daten, und die wahren Parameter (zum Vergleich).</p>
<p>Wir laden die Daten in ein DataFrame, <code>d</code>. Ich habe ein RT Experiment simuliert, in dem 4 Versuchspersonen in 2 Bedingungen (“A” und “B”) getestet wurden. Die experimentelle Manipulation sollte sich vor allem auf einen Parameter unterschieden. In dieser Übung geht es darum, herauszufinden, auf welchen Parameter die Manipulation einen Einfluss hat.</p>
</section><section id="aufgaben" class="level2"><h2 class="anchored" data-anchor-id="aufgaben">Aufgaben</h2>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Führen Sie die Parameterschätzung mehrmals aus, und berichten Sie die resultierenden Parameter. Es kann sein, dass nicht immer dasselbe rauskommt (deshlab machen wir es mehrmals). Welcher Parameter wurde beeinflusst?</p></li>
<li><p>Überlegen Sie sich, wie Sie weiterführen würden. Wie können Sie zeigen, dass es in einem Parameter einen Unterschied zwischen den Bedingungen gibt? Wie können Sie zeigen, dass es in den anderen Parameter keine Unterschied gibt? Beschreiben Sie in einem Paragraphen, was Sie sich überlegt haben.</p></li>
</ol>
</div>
</div>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-3_aca24c472feaa801fcfc9875d7dd28b1">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rtdists/rtdists/">rtdists</a></span><span class="op">)</span>

<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"ddm-data.csv"</span><span class="op">)</span>
<span class="va">participant_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"participant-params.csv"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="daten-vorbereiten" class="level2"><h2 class="anchored" data-anchor-id="daten-vorbereiten">Daten vorbereiten</h2>
<p>Wir schauen uns die Daten an:</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-4_caf1001a8f323dd06cb8839a73398045">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">d</span> |&gt; <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9,600
Columns: 4
$ ID        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ condition &lt;chr&gt; "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", "A", …
$ rt        &lt;dbl&gt; 0.6888584, 0.3411717, 1.6588621, 0.8845731, 0.7925147, 0.440…
$ response  &lt;chr&gt; "lower", "upper", "upper", "upper", "upper", "upper", "lower…</code></pre>
</div>
</div>
<p>Die Variablen <code>ID</code>, <code>condition</code> und <code>response</code> sollten Faktoren sein.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-5_866f07440e9236d17fa891caedf74d87">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">condition</span>, <span class="va">response</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">d</span> |&gt; <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9,600
Columns: 4
$ ID        &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ condition &lt;fct&gt; A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, A, …
$ rt        &lt;dbl&gt; 0.6888584, 0.3411717, 1.6588621, 0.8845731, 0.7925147, 0.440…
$ response  &lt;fct&gt; lower, upper, upper, upper, upper, upper, lower, upper, uppe…</code></pre>
</div>
</div>
<p>Weil es nur 4 VP sind, können wir die RTs von allen in einem Plot anschauen. Die <code>upper</code> Responses können wir hier als korrekte Antworten auffassen, die <code>lower</code> Responses als inkorrekte.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-6_f4c863ebfee51e3e1a8d6a34dd3c19d7">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">d</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">rt</span>, <span class="va">response</span>, fill <span class="op">=</span> <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"B"</span>, direction <span class="op">=</span> <span class="fl">1</span>,
                       begin <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, end <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">~</span> <span class="va">ID</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 488 rows containing non-finite values (stat_ydensity).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 488 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="solution_06_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="daten-zusammenfassen" class="level2"><h2 class="anchored" data-anchor-id="daten-zusammenfassen">Daten zusammenfassen</h2>
<p>UM uns einen Überblick zu verschaffen, fassen wir die Daten durch mittlere RT und “Accuracy” zusammen.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-7_e5c3aa268ea80d7ae936b6be49ba7b89">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">summary</span> <span class="op">&lt;-</span> <span class="va">d</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">condition</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>,
            median_rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>,
            accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">response</span> <span class="op">==</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ID'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
# Groups:   ID [4]
  ID    condition mean_rt median_rt accuracy
  &lt;fct&gt; &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 1     A           0.716     0.589    0.615
2 1     B           0.643     0.536    0.863
3 2     A           0.725     0.591    0.61 
4 2     B           0.617     0.519    0.842
5 3     A           0.843     0.696    0.598
6 3     B           0.685     0.578    0.864
7 4     A           0.715     0.591    0.602
8 4     B           0.617     0.518    0.85 </code></pre>
</div>
</div>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-8_0e9aaf5c05dbfedadc814c54d399eaee">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">summary</span> |&gt; 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">mean_rt</span>, <span class="va">accuracy</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">ID</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="solution_06_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In der Grafik sehen wir, dass die Accuracy in Bedingung “B” höher ist. Gleichzeitig ist die mittlere RT niedriger. Das ist ein Hinweis, dass hier kein Speed-Accuracy Tradeoff vorliegen kann. Dies bedeutet, dass die Vpn in der Bedingung “B” sich nicht mehr Zeit nehmen, um die Anzahl korrekter Antworten zu erhöhen.</p>
</section><section id="negative-loglikelihood-funktion-definieren" class="level2"><h2 class="anchored" data-anchor-id="negative-loglikelihood-funktion-definieren">Negative loglikelihood Funktion definieren</h2>
<p>Nun wollen wir für jede Person in den beiden Bedingungen die Parameter des DDM fitten. Wir definieren dafür eine Funktion, welche die <em>negative log likelihood</em> als Output hat.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-9_e693f6fe6c599274acaca9f99f3f39cc">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">diffusionloglik</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pars</span>, <span class="va">condition</span>, <span class="va">rt</span>, <span class="va">response</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>
  <span class="va">likelihoods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span>


  <span class="va">likelihoods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rtdists/man/Diffusion.html">ddiffusion</a></span><span class="op">(</span>rt <span class="op">=</span> <span class="va">rt</span>,
                             response <span class="op">=</span> <span class="va">response</span>,
                             a <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>,
                             v <span class="op">=</span>  <span class="va">pars</span><span class="op">[</span><span class="st">"v"</span><span class="op">]</span>,
                             t0 <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="st">"t0"</span><span class="op">]</span>,
                             z <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="st">"z"</span><span class="op">]</span> <span class="op">*</span> <span class="va">pars</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>,
                             s <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">likelihoods</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">likelihoods</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="startwerte-für-maxmimum-likelihood-schätzung" class="level2"><h2 class="anchored" data-anchor-id="startwerte-für-maxmimum-likelihood-schätzung">Startwerte für Maxmimum Likelihood Schätzung</h2>
<p>Für die Minimierung brauchen wir Anfangswerte. Diese werden für jeden zu schätzenden Parameter zufällig gewählt.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-10_a363483fee182f5b9179291a3c662e17">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">init_params</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.2</span>, <span class="fl">1.2</span><span class="op">)</span>,
              v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,
              z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.45</span>, <span class="fl">0.55</span><span class="op">)</span>,
              t0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>
  <span class="va">params</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="maxmimum-likelihood-schätzung" class="level2"><h2 class="anchored" data-anchor-id="maxmimum-likelihood-schätzung">Maxmimum Likelihood Schätzung</h2>
<p>Nun definieren wir zuerst ein paar Variablen.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-11_48eafa0c8d9f6d877860e261bc3d1556">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">participants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">n_participants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">participants</span><span class="op">)</span>
<span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span>
<span class="va">n_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span>

<span class="co"># no. parameters (a, v, z, t0)</span>
<span class="va">n_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">init_params</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Und nun schreiben wir eine zweifache <code>for</code>-Loop, über die Versuchspersonen, und über die Bedingungen innerhalb der Personen.</p>
<p>Führen Sie diesen Teil mehrmals aus.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-12_2df95aa47b566afe85ee791a924aa2b7">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">n_participants</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">participants</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n_conditions</span>, <span class="va">n_pars</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"v"</span>, <span class="st">"z"</span>, <span class="st">"t0"</span><span class="op">)</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>
  
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">ID</span> <span class="op">==</span> <span class="va">i</span>, <span class="va">condition</span> <span class="op">==</span> <span class="va">conditions</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  
    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nlminb.html">nlminb</a></span><span class="op">(</span><span class="fu">init_params</span><span class="op">(</span><span class="op">)</span>,
                <span class="va">diffusionloglik</span>,
                lower <span class="op">=</span> <span class="fl">0</span>,
                condition <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">condition</span>,
                rt <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">rt</span>,
                response <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">response</span><span class="op">)</span>
    
    <span class="va">estimates</span><span class="op">[</span><span class="va">j</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">par</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">p</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">estimates</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="geschätzte-parameterwerte" class="level2"><h2 class="anchored" data-anchor-id="geschätzte-parameterwerte">Geschätzte Parameterwerte</h2>
<p>Die geschätzten Parameter sind in einer List gespeichert.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-13_07a28db9cab8f82c3241c657b9900115">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
      a     v     z    t0
A 1.439 0.261 0.523 0.206
B 0.633 1.993 0.518 0.279

[[2]]
      a    v     z    t0
A 0.659 0.00 0.489 0.271
B 1.427 1.18 0.499 0.202

[[3]]
      a     v     z    t0
A 1.631 0.284 0.484 0.188
B 0.325 1.322 0.487 0.271

[[4]]
      a     v     z    t0
A 1.436 0.237 0.517 0.203
B 1.439 1.207 0.497 0.196</code></pre>
</div>
</div>
<p>In dieser Liste finden wir die geschätzten Parameter (<code>a</code>, <code>v</code>, <code>z</code>, <code>t0</code>) in den Bedingungen “A” und “B”. Jede Person ist ein Element dieser Liste, d.h. <code>p[[1]]</code> ist die erste Person.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-14_4d0aa124c22fdf15d38dad9e6b57e49b">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      a     v     z    t0
A 1.439 0.261 0.523 0.206
B 0.633 1.993 0.518 0.279</code></pre>
</div>
</div>
<p>Bei der ersten Versuchsperson lässt sich folgendes Muster erkennen: zwischen den Bedingungen “A” und “B” unterscheidet sich die Drift Rate <code>v</code> ziemlich stark (0.261 vs 1.993). Die anderen Parameter unterscheiden sich wenig zwischen den Bedingungen. Wir müssen hier aber vorsichtig sein: unser DDM braucht sehr viele Daten, um die Parameter zu schätzen. Es kann vorkommen, dass das Model zu flexibel ist, und “glaubt”, Merkmale der RT Verteilungen beispielsweise durch eine Kombination von Bias and Boundary Separation erklären zu können, obwohl der eigentlich verantwortliche Parameter die Drift Rate wäre (so wie hier). Deshalb habe ich die Anweisung gegeben, die Parameterschätzung mehrmals durchzuführen.</p>
<p>Wenn wir alle Vpn anschauen, scheint der Drift Rate-Unterschied zwischen den Bedingungen systematisch zu sein, die Parameter variieren wenig (ausser manchmal <code>a</code>; <code>z</code> und <code>t0</code> variieren kaum). Vor allem sind die Unterschiede nicht systematisch. Wenn wir mehr als nur 4 Personen hätten, könnten wir dies statistisch untersuchen (siehe Übung 7).</p>
<p>Idealerweise würden wir hier ein Model verwenden, in welchem nur die Drift Rate zwischen den Bedingungen variieren kann, während die anderen Parameter konstant bleiben; dies wäre aber Programmiertechnisch ein wenig anspruchsvoller.</p>
</section><section id="vergleich-mit-wahren-werten" class="level2"><h2 class="anchored" data-anchor-id="vergleich-mit-wahren-werten">Vergleich mit wahren Werten</h2>
<p>Die “wahren” Parameterwerte, das heisst die Werte mit denen die Daten erzeugt wurden, sehen für die 4 Vpn so aus. <code>v1</code> und <code>v2</code> entsprechen hier den Drift Rates in den Bedingungen “A” (<code>v1</code>) und “B” (<code>v2</code>).</p>
<p>Die wahren Werte der anderen Parameter unterscheiden sich nicht zwischen den Bedingungen. Dies bedeudet, dass die unterschiedlichen Schätzungen natürlich nur auf Schätzfehler und andere Fehlerquellen zurückzuführen sind.</p>
<div class="cell" data-hash="solution_06_cache/html/unnamed-chunk-15_3a759f5b002ddc1fa7f1da340f60abaa">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">participant_params</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
     ID     a    v1    v2     z    t0
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1  1.48 0.301  1.19 0.515 0.199
2     2  1.48 0.299  1.23 0.495 0.199
3     3  1.57 0.277  1.21 0.484 0.197
4     4  1.47 0.296  1.23 0.498 0.195</code></pre>
</div>
</div>
<p>In der Bedingung “B” ist die Drift Rate viel höher als in der Bedingung “A”. Dies führt dazu, dass die RTs in der Bedingung “B” kürzer sind, und gleichzeitig die Fehlerrate kleiner.</p>


</section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{ellis2022,
  author = {Andrew Ellis},
  title = {Übung 6: {Lösung}},
  date = {2022-05-10},
  url = {https://kogpsy.github.io/neuroscicomplabFS22//pages/solutions/solution_06.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-ellis2022" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Andrew Ellis. 2022. <span>“Übung 6: Lösung.”</span> May 10, 2022. <a href="https://kogpsy.github.io/neuroscicomplabFS22//pages/solutions/solution_06.html">https://kogpsy.github.io/neuroscicomplabFS22//pages/solutions/solution_06.html</a>.
</div></div></section></div></main><!-- /main --><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2022, Andrew Ellis</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kogpsy/neuroscicomplabFS22">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>