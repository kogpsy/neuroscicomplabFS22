---
title: "Reaktionszeiten: I"
description: |
  Anwendungen.
date: "2022-04-05"
author:
  - first_name: "Andrew"
    last_name: "Ellis"
    url: https://github.com/awellis
    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universit√§t Bern 
    affiliation_url: https://www.kog.psy.unibe.ch
    orcid_id: 0000-0002-2788-936X

citation_url: https://kogpsy.github.io/neuroscicomplab/response-times-1.html
# slug: ellis2021overview
bibliography: bibliography.bib
output: 
    distill::distill_article:
      toc: true
      toc_float: true
      toc_depth: 2
      code_folding: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, xaringanExtra-clipboard, echo=FALSE, include=FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clone fa-2x\" style=\"color: #301e64\"></i>",
    success_text = "<i class=\"fa fa-check fa-2x\" style=\"color: #90BE6D\"></i>",
    error_text = "<i class=\"fa fa-times fa-2x\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```

:::note
üëâ [R Code f√ºr dieses Kapitel downloaden](./files/response-times-1.R)

üëâ [Daten downloaden](./data/session-7.csv)
:::





# ADHD

```{r}
library(tidyverse)
```

```{r eval=FALSE, include=FALSE}
set.seed(243249)
d <- tibble(control = brms::rexgaussian(n = 300, 
                                        mu = 800, 
                                        sigma = 50, 
                                        beta = 150),
            adhd = brms::rexgaussian(n = 300, 
                                     mu = 850, 
                                     sigma = 50, 
                                     beta = 250))
d |> write_csv("data/session-7.csv")
```

```{r}
d <- read_csv("data/session-7.csv")
```
 
```{r}
glimpse(d)
```


```{r}
d <- d |>
  pivot_longer(everything(), 
               names_to = "group", values_to = "rt") |> 
  mutate(group = as_factor(group)) |> 
  arrange(group)
```

```{r}
glimpse(d)
```

```{r}
p1 <- d |> 
  ggplot(aes(rt)) +
  geom_histogram(aes(y = ..density..), 
                 colour = "black", fill = "white",
                 binwidth = 10) +
  geom_density(lwd = 1, colour = 4,
               fill = 4, alpha = 0.25) +
  facet_wrap(~group, ncol = 1) +
  xlab("Response time [ms]") +
  xlim(c(0, 2200))
```

```{r}
p1
```




## Zusammenfassen: zentrale Tendenz und Dispersion


### Mittelwert und Standardabweichung

```{r}
d %>% 
  group_by(group) %>% 
  summarise(mean = mean(rt),
            sd = sd(rt))
```


### Median und Interquartilsbereich

Der Interquartilsbereich repr√§ntiert den Unterschied zwischen dem ersten (25. Perzentil) und dritten (75. Perzentil) Quartil. In diesem Bereich befinden sich 50% der Datenpunkte.

```{r}
d %>% 
  group_by(group) %>% 
  summarise(mean = median(rt),
            q25 = quantile(rt, probs = 0.25),
            q75 = quantile(rt, probs = 0.75)) |> 
  mutate(IQR = q75 - q25)
```


```{r}
d %>% 
  group_by(group) %>% 
  summarise(mean = median(rt),
            IQR = IQR(rt))
```


```{r}
funs <- list(mean = mean, median = median, 
             sd = sd, IQR = IQR)

by_group <- d |>
  group_by(group) |>
  summarise(across(rt, funs, .names = "{.fn}")) |>
  mutate(across(where(is.numeric), ~round(., 2)))
```

```{r}
by_group
```


```{r}
p1 +
  geom_vline(aes(xintercept = mean), 
             data = by_group,
             color = "steelblue",
             lwd = 1.5) +
  geom_vline(aes(xintercept = median), 
             data = by_group, 
             color = "red",
             lwd = 1.5)
```


### Zentrale Tendenz bei schiefen Verteilungen

Sowohl Mittelwert als auch Median sind jedoch problematisch als Masse der zentralen Tendenz f√ºr asymmetrische Verteilungen. Der Mittelwert kann durch eine hohe Schiefe und Ausreissern verschoben werden, und repr√§sentiert die zentrale Tendenz der Verteilung nicht besonders gut. 

Der Median ist ein besseres Mass f√ºr eine typische Beobachtung aus dieser Verteilung, ist jedoch nicht erwartungstreu, das heisst der Median √ºbersch√§tzt den Populationsmedian. Der Grad der √úbersch√§tzung steigt mit sinkender Anzahl Beobachtungen (d.h. vor allem bei kleinen Stichproben).


### Quantile


```{r}
deciles <- seq(0.1, 0.9, length.out = 9)
```

```{r}
quantile_fun <- function(x, probs = c(0.25, 0.5, 0.75)) {
  tibble(rt = quantile(x, probs, type = 8), quantile = probs)
}
```


```{r}
d_quantiles <- d %>% 
  group_by(group) %>% 
  summarise(quantile_fun(rt, probs = deciles))
```

```{r}
d_quantiles
```

### Shift function

Wir m√ºssen nun den Dataframe mit den Quantilen ins "wide" Format konvertieren, um zwei Spalten f√ºr die `control` und `adhd` Gruppen zu erhalten. Danach k√∂nnen wir die Differenzen zwischen den Gruppen f√ºr jedes Quantil berechnen.


```{r}
d_quantile_differences <- d_quantiles |> 
  pivot_wider(names_from = "group", values_from = "rt") 
```


```{r}
d_quantile_differences
```

```{r}
d_quantile_differences <- d_quantile_differences |> 
    mutate(`control - adhd` = control - adhd)
```


```{r}
d_quantile_differences
```




### Shift function grafisch darstellen

```{r}
d_quantile_differences %>% 
  ggplot(aes(x = control, y = `control - adhd`)) +
  geom_hline(yintercept = 0, linetype = 3) +
  geom_vline(xintercept = d_quantile_differences %>% 
               filter(quantile == "50%") %>% 
               select(adhd) %>% 
               pull(), linetype = 3) +
  geom_line(aes(group = 1), color = "steelblue", size = 2) +
  geom_point(shape = 21, color = "steelblue", fill = "white", size = 5, stroke = 1) +
  coord_cartesian(ylim = c(-300, 300))
```

```{r include=TRUE, eval = FALSE}
install.packages("remotes")
remotes::install_github("GRousselet/rogme")
```

```{r}
# library(rogme)
```

```{r}
out <- rogme::shifthd(d, rt ~ group)
```

```{r}
rogme::plot_sf(out)
```

