---
title: "Reaktionszeiten: II"
description: |
  Anwendungen.
date: "2022-04-12"
author:
  - first_name: "Andrew"
    last_name: "Ellis"
    url: https://github.com/awellis
    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universit√§t Bern 
    affiliation_url: https://www.kog.psy.unibe.ch
    orcid_id: 0000-0002-2788-936X

citation_url: https://kogpsy.github.io/neuroscicomplab/response-times-2.html
# slug: ellis2021overview
bibliography: bibliography.bib
output: 
    distill::distill_article:
      toc: true
      toc_float: true
      toc_depth: 2
      code_folding: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, xaringanExtra-clipboard, echo=FALSE, include=FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clone fa-2x\" style=\"color: #301e64\"></i>",
    success_text = "<i class=\"fa fa-check fa-2x\" style=\"color: #90BE6D\"></i>",
    error_text = "<i class=\"fa fa-times fa-2x\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```

:::note
üëâ [R Code f√ºr dieses Kapitel downloaden](./files/response-times-2.R)
:::





# Hierarchical Shift Function


Wir schauen uns Daten aus einem Lexical Decision Task [@wagenmakersLinearRelationMean2007] an, bei dem Versuchspersonen W√∂rter als entweder `word` oder `non-word` klassifizieren mussten. Es ist bekannt, dass W√∂rter welche h√§ufiger vorkommen schneller klassifiziert werden k√∂nnen, als seltene W√∂rter. In diesem Experiment mussten Versuchspersonen diesen Task unter zwei Bedingungen durchf√ºhren. In der `speed` Bedingung mussten sie sich so schnell wie m√∂glich entscheiden, in der `accuracy` Bedingung mit so wenig Fehler wie m√∂glich. 

Hier untersuchen wir also den Unterschied in der Reaktionszeit zwischen zwei "within" Bedingungen. Die Daten befinden sich im Package `rtdists`, welches zuerst installiert werden sollte.



```{r}
library(tidyverse)
library(rtdists)
library(viridis)

data(speed_acc) 

speed_acc <- speed_acc |>
  as_tibble()


df_speed_acc <- speed_acc |> 
   # zwischen 180 ms and 3000 ms
  filter(rt > 0.18, rt < 3) |> 
   # zu Character konvertieren (damit filter funktioniert)
  mutate(across(c(stim_cat, response), as.character)) |> 
  # Korrekte Antworten
  filter(response != 'error', 
         stim_cat == response) |> 
  # wieder zu Factor konvertieren
  mutate(across(c(stim_cat, response), as_factor))
```


```{r}
df_speed_acc
```


Wir schauen uns ein paar Versuchspersonen grafisch an:

```{r}
plot_hist <- function(d) {
  d |> 
  ggplot(aes(x = rt,
             fill = condition,
             color = condition,)) + 
    geom_histogram(aes(y = ..density..), 
                   alpha = 0.5, bins = 60) + 
    facet_wrap(~id) +
    coord_cartesian(xlim=c(0, 1.6)) +
    scale_fill_viridis(discrete = TRUE, option = "E") +
    scale_color_viridis(discrete = TRUE, option = "E")
}

plot_dens <- function(d) {
  d |> 
  ggplot(aes(x = rt,
             fill = condition,
             color = condition,)) + 
    geom_density(alpha = 0.5) +
    facet_wrap(~id) +
    coord_cartesian(xlim=c(0, 1.6)) +
    scale_fill_viridis(discrete = TRUE, option = "E") +
    scale_color_viridis(discrete = TRUE, option = "E")
}
```


Entweder explizit ausw√§hlen:

```{r}
data_plot <- df_speed_acc |> 
  filter(id %in% c(1, 8, 11, 15))
```

```{r}
library(patchwork)

plot_hist(data_plot) /
  plot_dens(data_plot)
```
Oder dem Zufall √ºberlassen:

```{r}
dd <- df_speed_acc |> 
  filter(id %in% sample(levels(id), 4)) 


plot_hist(dd) /
  plot_dens(dd)
```




:::exercise
Verschaffen Sie sich einen √úberblick (schauen Sie mehrere Vpn an).
:::



:::exercise
Was w√ºrden Sie anhand der Histogramme erwarten?
:::


:::exercise
Berechnen Sie nun die Differenzen der Dezile zwischen den Bedingungen f√ºr jede Versuchsperson.
:::


```{r}
out <- rogme::hsf(df_speed_acc, rt ~ condition + id)
```

```{r}
rogme::plot_hsf(out)
```


```{r}
out_pb <- rogme::hsf_pb(df_speed_acc, rt ~ condition + id)
```

```{r}
rogme::plot_hsf_pb(out_pb, interv = "ci")
```





In dieser Grafik sehen wir auf der X-Achse die Dezile der `accuracy` Bedingung und auf der Y-Achse die Differenz `accuracy - speed`. Die Differenz ist bei jedem Dezil positiv und scheint steig gr√∂sser zu werden. Die `accuracy` Bedingung f√ºhrt also zu l√§ngeren und variableren Reaktionszeiten. Die Bedingungen unterscheiden sich im Median, aber wenn wir nur das ber√ºcksichtigt h√§tten, w√ºrden wir verpassen, dass sich die Verteilungen sehr stark am rechten Ende der Verteilung unterscheiden.


Zum Vergleich berechnen wir noch Bedingungsmittelwerte der Median Reaktionszeiten.



```{r}
by_subject <- df_speed_acc |> 
  group_by(id, condition) |> 
  summarise(mean = median(rt))

agg <- Rmisc::summarySEwithin(by_subject,
                       measurevar = "mean",
                       withinvars = "condition",
                       idvar = "id",
                       na.rm = FALSE,
                       conf.interval = .95)
```

```{r}
agg |> 
  ggplot(aes(condition, mean, fill = condition)) +
  geom_col(alpha = 0.8) +
  geom_line(aes(group = 1), linetype = 3) +   
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se),
                width = 0.1, size=1, color="black") +
  scale_fill_viridis(discrete=TRUE, option="cividis") +
  theme(legend.position = "none")
```
